<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>Diff result</title>
<style type="text/css">
body { width: 100%; font-size: 10pt; }
h1 { font-size: 125%; }
div.content { font-family: Verdana, "DejaVu Sans Condensed", "Liberation Sans","Nimbus Sans L", Helvetica, sans-serif; margin : 1em auto; width: 100%; }
div.left { float: left; width: 48%; padding: 1em; }
div.right { float: right; width: 48%; padding: 1em; }
div.code { font-family: "Liberation Mono", "Courrier New", monospace; border:1px solid black;}
div.clear { clear: both; }
span.del { background-color : red; font-weight: normal; font-style: normal;}
span.add { background-color : lightgreen; font-weight: bold; font-style: normal;}
span.upd { background-color : orange; font-weight: bold; font-style: italic;}
span.id { background-color : white; font-weight: normal; font-style: normal;}
span.mv { background-color : yellow; font-weight: normal; font-style: normal;}
</style></head><body><div class="content"><div class="left">
<h1>left_ScarabRequestTool_1.36.java</h1>
<div class="code">
<div class="id">
package org.tigris.scarab.tools;<br/>
<br/>
/* ================================================================<br/>
 * Copyright (c) 2000-2001 CollabNet.  All rights reserved.<br/>
 * <br/>
 * Redistribution and use in source and binary forms, with or without<br/>
 * modification, are permitted provided that the following conditions are<br/>
 * met:<br/>
 * <br/>
 * 1. Redistributions of source code must retain the above copyright<br/>
 * notice, this list of conditions and the following disclaimer.<br/>
 * <br/>
 * 2. Redistributions in binary form must reproduce the above copyright<br/>
 * notice, this list of conditions and the following disclaimer in the<br/>
 * documentation and/or other materials provided with the distribution.<br/>
 * <br/>
 * 3. The end-user documentation included with the redistribution, if<br/>
 * any, must include the following acknowlegement: "This product includes<br/>
 * software developed by Collab.Net &lt;http://www.Collab.Net/&gt;."<br/>
 * Alternately, this acknowlegement may appear in the software itself, if<br/>
 * and wherever such third-party acknowlegements normally appear.<br/>
 * <br/>
 * 4. The hosted project names must not be used to endorse or promote<br/>
 * products derived from this software without prior written<br/>
 * permission. For written permission, please contact info@collab.net.<br/>
 * <br/>
 * 5. Products derived from this software may not use the "Tigris" or <br/>
 * "Scarab" names nor may "Tigris" or "Scarab" appear in their names without <br/>
 * prior written permission of Collab.Net.<br/>
 * <br/>
 * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED<br/>
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF<br/>
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.<br/>
 * IN NO EVENT SHALL COLLAB.NET OR ITS CONTRIBUTORS BE LIABLE FOR ANY<br/>
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL<br/>
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE<br/>
 * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS<br/>
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER<br/>
 * IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR<br/>
 * OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF<br/>
 * ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.<br/>
 *<br/>
 * ====================================================================<br/>
 * <br/>
 * This software consists of voluntary contributions made by many<br/>
 * individuals on behalf of Collab.Net.<br/>
 */ <br/>
<br/>
// Turbine<br/>
import org.apache.torque.om.NumberKey;<br/>
import org.apache.torque.om.ObjectKey;<br/>
import org.apache.torque.om.ComboKey;<br/>
import org.apache.turbine.RunData;<br/>
import org.apache.turbine.modules.Module;<br/>
import org.apache.turbine.tool.IntakeTool;<br/>
import org.apache.turbine.services.intake.model.Group;<br/>
import <span class="upd"><span class="upd"><span class="upd">org.apache.<span class="del">turbine</span></span>.<span class="mv">util</span></span>.<span class="del">Log</span></span>;<br/>
<span class="del">import <span class="del"><span class="mv"><span class="upd"><span class="upd"><span class="upd">org.<span class="del">apache</span></span>.<span class="mv">fulcrum</span></span>.<span class="mv">pool</span></span></span>.<span class="mv">Recyclable</span></span>;</span><br/>
<br/>
// Scarab<br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">ScarabUser</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">ScarabUserImplPeer</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">Issue</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">IssuePeer</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">Query</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">QueryPeer</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">Depend</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">DependPeer</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">ScarabModulePeer</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">Attribute</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">Attachment</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">AttachmentPeer</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">AttributeOption</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">AttributeOptionPeer</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">RModuleAttribute</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="mv"><span class="upd">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span></span>.<span class="mv">RModuleAttributePeer</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="del"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">services</span></span>.<span class="mv">module</span></span>.<span class="mv">ModuleEntity</span></span>;</span><br/>
<span class="del">import <span class="del"><span class="del"><span class="mv"><span class="upd">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">services</span></span></span>.<span class="mv">module</span></span>.<span class="mv">ModuleManager</span></span>;</span><br/>
<span class="del">import <span class="mv"><span class="upd">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.util.<span class="mv">ScarabConstants</span></span></span>;</span><br/>
<span class="del">import <span class="del"><span class="del"><span class="del"><span class="del"><span class="del"><span class="del">org</span>.<span class="mv">tigris</span></span>.<span class="mv">scarab</span></span>.<span class="del">util</span></span>.<span class="mv">word</span></span>.<span class="mv">IssueSearch</span></span>;</span><br/>
<br/>
/**<br/>
 * This class is used by the Scarab API<br/>
 */<br/>
public class ScarabRequestTool implements ScarabRequestScope,<br/>
                                          Recyclable<br/>
{<br/>
    /** the object containing request specific data */<br/>
    private RunData data;<br/>
<br/>
    /**<br/>
     * A User object for use within the Scarab API.<br/>
     */<br/>
    private ScarabUser user = null;<br/>
<br/>
    /**<br/>
     * A Issue object for use within the Scarab API.<br/>
     */<br/>
    private Issue issue = null;<br/>
<br/>
    /**<br/>
     * A Attribute object for use within the Scarab API.<br/>
     */<br/>
    private Attribute attribute = null;<br/>
<br/>
    /**<br/>
     * A Attachment object for use within the Scarab API.<br/>
     */<br/>
    private Attachment attachment = null;<br/>
<br/>
    /**<br/>
     * A Depend object for use within the Scarab API.<br/>
     */<br/>
    private Depend depend = null;<br/>
<br/>
    /**<br/>
     * A Query object for use within the Scarab API.<br/>
     */<br/>
    private Query query = null;<br/>
<br/>
    /**<br/>
     * A ModuleEntity object for use within the Scarab API.<br/>
     */<br/>
    private ModuleEntity module = null;<br/>
<br/>
    /**<br/>
     * A AttributeOption object for use within the Scarab API.<br/>
     */<br/>
    private AttributeOption attributeOption = null;<br/>
    <br/>
    public void init(Object data)<br/>
    {<br/>
        this.data = (RunData)data;<br/>
    }<br/>
<br/>
    /**<br/>
     * nulls out the issue and user objects<br/>
     */<br/>
    public void refresh()<br/>
    {<br/>
        this.user = null;<br/>
        this.issue = null;<br/>
    }<br/>
<br/>
    /**<br/>
     * Constructor does initialization stuff<br/>
     */    <br/>
    public ScarabRequestTool()<br/>
    {<br/>
        //intake = new IntakeSystem();<br/>
    }<br/>
<br/>
    /**<br/>
     * A Attribute object for use within the Scarab API.<br/>
     */<br/>
    public void setAttribute (Attribute attribute)<br/>
    {<br/>
        this.attribute = attribute;<br/>
    }<br/>
<br/>
    /**<br/>
     * A Depend object for use within the Scarab API.<br/>
     */<br/>
    public void setDepend (Depend depend)<br/>
    {<br/>
        this.depend = depend;<br/>
    }<br/>
<br/>
    /**<br/>
     * A Query object for use within the Scarab API.<br/>
     */<br/>
    public void setQuery (Query query)<br/>
    {<br/>
        this.query = query;<br/>
    }<br/>
<br/>
    private IntakeTool getIntakeTool()<br/>
    {<br/>
        return (IntakeTool)Module.getTemplateContext(data)<br/>
            .get(ScarabConstants.INTAKE_TOOL);<br/>
    }<br/>
<br/>
<br/>
    /**<br/>
     * A Attribute object for use within the Scarab API.<br/>
     */<br/>
    public void setAttributeOption (AttributeOption option)<br/>
    {<br/>
        this.attributeOption = option;<br/>
    }<br/>
<br/>
    /**<br/>
     * A Attribute object for use within the Scarab API.<br/>
     */<br/>
    public AttributeOption getAttributeOption()<br/>
        throws Exception<br/>
    {<br/>
try{<br/>
        if (attributeOption == null)<br/>
        {<br/>
            String optId = data.getParameters()<br/>
                .getString("currentAttributeOption"); <br/>
            if ( optId == null )<br/>
            {<br/>
                attributeOption = new AttributeOption();                <br/>
            }<br/>
            else <br/>
            {<br/>
                attributeOption = AttributeOptionPeer<br/>
                    .retrieveByPK(new NumberKey(optId));<br/>
            }<br/>
        }<br/>
}catch(Exception e){e.printStackTrace();}<br/>
        return attributeOption;<br/>
    }<br/>
<br/>
    /**<br/>
     * A User object for use within the Scarab API.<br/>
     */<br/>
    public void setUser (ScarabUser user)<br/>
    {<br/>
        // this.user = user;<br/>
    }<br/>
<br/>
    /**<br/>
     * A User object for use within the Scarab API.<br/>
     */<br/>
    public ScarabUser getUser()<br/>
    {<br/>
        if (user == null)<br/>
        {<br/>
            this.user = (ScarabUser)data.getUser();<br/>
        }<br/>
        return (ScarabUser)data.getUser();<br/>
    }<br/>
<br/>
    /**<br/>
     * A User object for use within the Scarab API.<br/>
     */<br/>
    public ScarabUser getUser(String id)<br/>
     throws Exception<br/>
    {<br/>
        ScarabUser su = null;<br/>
        try<br/>
        {<br/>
            ObjectKey pk = (ObjectKey)new NumberKey(id);<br/>
            su = (ScarabUser)ScarabUserImplPeer.retrieveScarabUserImplByPK(pk);<br/>
        }<br/>
        <span class="del">catch (<span class="mv">Exception e</span>)<br/>
        <span class="del">{<br/>
            <span class="del"><span class="del"><span class="del">Log</span>.<span class="del">error</span> (<span class="del">"SRT.getUser(id) error: "</span>, <span class="mv">e</span>)</span>;</span><br/>
        }</span></span><br/>
        return su;<br/>
    }<br/>
<br/>
    /**<br/>
     * A User object for use within the Scarab API.<br/>
     */<br/>
    public ScarabUser getUser(Integer id)<br/>
        throws Exception<br/>
    {<br/>
        return getUser(id.toString());<br/>
    }<br/>
<br/>
    /**<br/>
     * A Attribute object for use within the Scarab API.<br/>
     */<br/>
    public Attribute getAttribute()<br/>
     throws Exception<br/>
    {<br/>
try{<br/>
        if (attribute == null)<br/>
        {<br/>
            String attId = getIntakeTool()<br/>
                .get("Attribute", IntakeTool.DEFAULT_KEY).get("Id").toString();<br/>
            if ( attId == null || attId.length() == 0 )<br/>
            {<br/>
                attribute = Attribute.getInstance();<br/>
            }<br/>
            else <br/>
            {<br/>
                attribute = Attribute.getInstance(new NumberKey(attId));<br/>
            }<br/>
        }        <br/>
}<span class="mv">catch(<span class="mv">Exception e</span>){<span class="mv">e</span>.printStackTrace();}</span><br/>
        return attribute;<br/>
 <br/>
   }<br/>
<br/>
    /**<br/>
     * A Query object for use within the Scarab API.<br/>
     */<br/>
    public Query getQuery()<br/>
     throws Exception<br/>
    {<br/>
        try<br/>
        {<br/>
            if (query == null)<br/>
            {<br/>
                String queryId = getIntakeTool()<br/>
                    .get("Query", IntakeTool.DEFAULT_KEY).get("Id").toString();<br/>
                if ( queryId == null || queryId.length() == 0 )<br/>
                {<br/>
                    query = Query.getInstance();<br/>
                }<br/>
                else <br/>
                {<br/>
                    query = QueryPeer.retrieveByPK(new NumberKey(queryId));<br/>
                }<br/>
            }        <br/>
        }        <br/>
        <span class="mv">catch (<span class="mv">Exception e</span>)<br/>
        {<br/>
            <span class="mv">e</span>.printStackTrace();<br/>
        }</span><br/>
        return query;<br/>
 <br/>
   }<br/>
<br/>
    /**<br/>
     * A Depend object for use within the Scarab API.<br/>
     */<br/>
    public Depend getDepend()<br/>
     throws Exception<br/>
    {<br/>
        try<br/>
        {<br/>
            if (depend == null)<br/>
            {<br/>
                String dependId = getIntakeTool()<br/>
                    .get("Depend", IntakeTool.DEFAULT_KEY).get("Id").toString();<br/>
                if ( dependId == null || dependId.length() == 0 )<br/>
                {<br/>
                    depend = Depend.getInstance();<br/>
                }<br/>
                else <br/>
                {<br/>
                    depend = DependPeer.retrieveByPK(new NumberKey(dependId));<br/>
                }<br/>
            }        <br/>
        }        <br/>
        <span class="mv">catch (<span class="mv">Exception e</span>)<br/>
        {<br/>
            <span class="mv">e</span>.printStackTrace();<br/>
        }</span><br/>
        return depend;<br/>
 <br/>
   }<br/>
<br/>
    /**<br/>
     * A Attachment object for use within the Scarab API.<br/>
     */<br/>
    public Attachment getAttachment()<br/>
     throws Exception<br/>
    {<br/>
try{<br/>
        if (attachment == null)<br/>
        {<br/>
            Group att = getIntakeTool()<br/>
                .get("Attachment", IntakeTool.DEFAULT_KEY, false);<br/>
            if ( att != null ) <br/>
            {            <br/>
                String attId =  att.get("Id").toString();<br/>
                if ( attId == null || attId.length() == 0 )<br/>
                {<br/>
                    attachment = new Attachment();<br/>
                }<br/>
                else <br/>
                {<br/>
                    attachment = AttachmentPeer<br/>
                        .retrieveByPK(new NumberKey(attId));<br/>
                }<br/>
            }<br/>
            else <br/>
            {<br/>
                attachment = new Attachment();<br/>
            }<br/>
        }        <br/>
}catch(Exception e)<span class="mv">{<span class="mv">e</span>.printStackTrace(); <span class="mv">throw e;</span>}</span><br/>
        return attachment;<br/>
 <br/>
   }<br/>
<br/>
    /**<br/>
     * A Module object for use within the Scarab API.<br/>
     */<br/>
    public void setModule(ModuleEntity module)<br/>
    {<br/>
        this.module = module;<br/>
    }<br/>
<br/>
    /**<br/>
     * Get an Module object. <br/>
     *<br/>
     * @return a &lt;code&gt;ModuleEntity&lt;/code&gt; value<br/>
     */<br/>
    public ModuleEntity getModule()<br/>
     throws Exception<br/>
    {<br/>
      try{<br/>
            String modId = getIntakeTool()<br/>
                .get("Module", IntakeTool.DEFAULT_KEY).get("Id").toString();<br/>
            if ( modId == null || modId.length() == 0 )<br/>
            {<br/>
                module = ModuleManager.getInstance();<br/>
            }<br/>
            else <br/>
            {<br/>
                module = ModuleManager.getInstance(new NumberKey(modId));<br/>
            }<br/>
      }catch(Exception e)<span class="mv">{<span class="mv">e</span>.printStackTrace();}</span><br/>
        return module;<br/>
 <br/>
   }<br/>
    /**<br/>
     * Get an RModuleAttribute object. <br/>
     *<br/>
     * @return a &lt;code&gt;Module&lt;/code&gt; value<br/>
     */<br/>
    public RModuleAttribute getRModuleAttribute()<br/>
        throws Exception<br/>
    {<br/>
        RModuleAttribute rma = null;<br/>
      try{<br/>
            ComboKey rModAttId = (ComboKey)getIntakeTool()<br/>
                .get("RModuleAttribute", IntakeTool.DEFAULT_KEY)<br/>
                .get("Id").getValue();<br/>
            if ( rModAttId == null )<br/>
            {<br/>
                NumberKey attId = (NumberKey)getIntakeTool()<br/>
                    .get("Attribute", IntakeTool.DEFAULT_KEY)<br/>
                    .get("Id").getValue();<br/>
                if ( attId != null &amp;&amp; getUser().getCurrentModule() != null )<br/>
                {<br/>
                    NumberKey[] nka = {attId, <br/>
                        getUser().getCurrentModule().getModuleId()};<br/>
                    rma = RModuleAttributePeer.retrieveByPK(new ComboKey(nka));<br/>
                }<br/>
                else <br/>
                {<br/>
                    rma = new RModuleAttribute();<br/>
                }<br/>
            }<br/>
            else <br/>
            {<br/>
                rma = RModuleAttributePeer.retrieveByPK(rModAttId);<br/>
            }<br/>
      }catch(Exception e)<span class="mv">{<span class="mv">e</span>.printStackTrace();}</span><br/>
        return rma;<br/>
 <br/>
   }<br/>
<br/>
    <br/>
<br/>
    /**<br/>
     * Get a specific module by key value.<br/>
     *<br/>
     * @param key a &lt;code&gt;String&lt;/code&gt; value<br/>
     * @return a &lt;code&gt;Module&lt;/code&gt; value<br/>
     */<br/>
    public ModuleEntity getModule(String key) throws Exception<br/>
    {<br/>
        return (ModuleEntity) ScarabModulePeer.retrieveByPK(new NumberKey(key));<br/>
    }<br/>
<br/>
<br/>
    /**<br/>
     * A Issue object for use within the Scarab API.<br/>
     */<br/>
    public void setIssue(Issue issue)<br/>
    {<br/>
        this.issue = issue;<br/>
    }<br/>
<br/>
    /**<br/>
     * Get an Issue object. If it is the first time calling,<br/>
     * it will be a new blank issue object.<br/>
     *<br/>
     * @return a &lt;code&gt;Issue&lt;/code&gt; value<br/>
     */<br/>
    public Issue getIssue()<br/>
        throws Exception<br/>
    {<br/>
        if (issue == null)<br/>
        {<br/>
            Group issueGroup = getIntakeTool()<br/>
                .get("Issue", IntakeTool.DEFAULT_KEY, false);<br/>
            if ( issueGroup != null ) <br/>
            {            <br/>
                String issueId =  issueGroup.get("Id").toString();<br/>
                if ( issueId == null || issueId.length() == 0 )<br/>
                {<br/>
                    issue = new Issue();<br/>
                }<br/>
                else <br/>
                {<br/>
                    issue = IssuePeer<br/>
                        .retrieveByPK(new NumberKey(issueId));<br/>
                }<br/>
            }<br/>
            else if ( data.getParameters().getString("issue_id") != null ) <br/>
            {                <br/>
                String issueId = data.getParameters().getString("issue_id");<br/>
                if ( issueId.length() == 0 )<br/>
                {<br/>
                    issue = new Issue();<br/>
                }<br/>
                else <br/>
                {<br/>
                    issue = IssuePeer<br/>
                        .retrieveByPK(new NumberKey(issueId));<br/>
                }<br/>
            }<br/>
            else <br/>
            {<br/>
                issue = new Issue();<br/>
            }<br/>
        }        <br/>
<br/>
        return issue;<br/>
    }<br/>
<br/>
    /**<br/>
     * Get a new SearchIssue object. <br/>
     *<br/>
     * @return a &lt;code&gt;Issue&lt;/code&gt; value<br/>
     */<br/>
    public IssueSearch getSearch()<br/>
        throws Exception<br/>
    {<br/>
        IssueSearch search = new IssueSearch();<br/>
        search.setModuleCast(((ScarabUser)getUser()).getCurrentModule());<br/>
        return search;<br/>
    }<br/>
<br/>
    /**<br/>
     * The id may be a primary key or an issue id.<br/>
     *<br/>
     * @param key a &lt;code&gt;String&lt;/code&gt; value<br/>
     * @return a &lt;code&gt;Issue&lt;/code&gt; value<br/>
     */<br/>
    public Issue getIssue(String key)<br/>
    {<br/>
        Issue issue = null;<br/>
        try<br/>
        {<br/>
            issue = IssuePeer.retrieveByPK(new NumberKey(key));<br/>
        }<br/>
        catch (Exception e)<br/>
        {<br/>
            // was not a primary key, try fid<br/>
            Issue.FederatedId fid = new Issue.FederatedId(key);<br/>
            if ( fid.getDomain() == null ) <br/>
            {<br/>
                // handle null (always null right now)<br/>
            }<br/>
            issue = Issue.getIssueById(fid);<br/>
        }<br/>
        return issue;<br/>
    }<br/>
<br/>
<br/>
<br/>
    // ****************** Recyclable implementation ************************<br/>
<br/>
    private boolean disposed;<br/>
<br/>
    /**<br/>
     * Recycles the object for a new client. Recycle methods with<br/>
     * parameters must be added to implementing object and they will be<br/>
     * automatically called by pool implementations when the object is<br/>
     * taken from the pool for a new client. The parameters must<br/>
     * correspond to the parameters of the constructors of the object.<br/>
     * For new objects, constructors can call their corresponding recycle<br/>
     * methods whenever applicable.<br/>
     * The recycle methods must call their super.<br/>
     */<br/>
    public void recycle()<br/>
    {<br/>
        disposed = false;<br/>
    }<br/>
<br/>
    /**<br/>
     * Disposes the object after use. The method is called<br/>
     * when the object is returned to its pool.<br/>
     * The dispose method must call its super.<br/>
     */<br/>
    public void dispose()<br/>
    {<br/>
        data = null;<br/>
        user = null;<br/>
        issue = null;<br/>
        attribute = null;<br/>
<br/>
        disposed = true;<br/>
    }<br/>
<br/>
    /**<br/>
     * Checks whether the recyclable has been disposed.<br/>
     * @return true, if the recyclable is disposed.<br/>
     */<br/>
    public boolean isDisposed()<br/>
    {<br/>
        return disposed;<br/>
    }<br/>
}<br/>
<br/>
<br/>
<br/>
</div>
</div>
</div>
<div class="right">
<h1>right_ScarabRequestTool_1.37.java</h1>
<div class="code">
<div class="id">
package org.tigris.scarab.tools;<br/>
<br/>
/* ================================================================<br/>
 * Copyright (c) 2000-2001 CollabNet.  All rights reserved.<br/>
 * <br/>
 * Redistribution and use in source and binary forms, with or without<br/>
 * modification, are permitted provided that the following conditions are<br/>
 * met:<br/>
 * <br/>
 * 1. Redistributions of source code must retain the above copyright<br/>
 * notice, this list of conditions and the following disclaimer.<br/>
 * <br/>
 * 2. Redistributions in binary form must reproduce the above copyright<br/>
 * notice, this list of conditions and the following disclaimer in the<br/>
 * documentation and/or other materials provided with the distribution.<br/>
 * <br/>
 * 3. The end-user documentation included with the redistribution, if<br/>
 * any, must include the following acknowlegement: "This product includes<br/>
 * software developed by Collab.Net &lt;http://www.Collab.Net/&gt;."<br/>
 * Alternately, this acknowlegement may appear in the software itself, if<br/>
 * and wherever such third-party acknowlegements normally appear.<br/>
 * <br/>
 * 4. The hosted project names must not be used to endorse or promote<br/>
 * products derived from this software without prior written<br/>
 * permission. For written permission, please contact info@collab.net.<br/>
 * <br/>
 * 5. Products derived from this software may not use the "Tigris" or <br/>
 * "Scarab" names nor may "Tigris" or "Scarab" appear in their names without <br/>
 * prior written permission of Collab.Net.<br/>
 * <br/>
 * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED<br/>
 * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF<br/>
 * MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.<br/>
 * IN NO EVENT SHALL COLLAB.NET OR ITS CONTRIBUTORS BE LIABLE FOR ANY<br/>
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL<br/>
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE<br/>
 * GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS<br/>
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER<br/>
 * IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR<br/>
 * OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF<br/>
 * ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.<br/>
 *<br/>
 * ====================================================================<br/>
 * <br/>
 * This software consists of voluntary contributions made by many<br/>
 * individuals on behalf of Collab.Net.<br/>
 */ <br/>
<br/>
// Turbine<br/>
import org.apache.torque.om.NumberKey;<br/>
import org.apache.torque.om.ObjectKey;<br/>
import org.apache.torque.om.ComboKey;<br/>
import org.apache.turbine.RunData;<br/>
import org.apache.turbine.modules.Module;<br/>
import org.apache.turbine.tool.IntakeTool;<br/>
import org.apache.turbine.services.intake.model.Group;<br/>
import <span class="upd"><span class="upd"><span class="upd">org.apache.<span class="mv">fulcrum</span></span>.<span class="mv">pool</span></span>.<span class="mv">Recyclable</span></span>;<br/>
<br/>
// Scarab<br/>
<span class="add">import <span class="add"><span class="mv"><span class="upd"><span class="upd"><span class="upd">org.<span class="mv">tigris</span></span>.<span class="mv">scarab</span></span>.<span class="mv">om</span></span></span>.<span class="mv">ScarabUser</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">ScarabUserImplPeer</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">Issue</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">IssuePeer</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">Query</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">QueryPeer</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">Depend</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">DependPeer</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">ScarabModulePeer</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">Attribute</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">Attachment</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">AttachmentPeer</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">AttributeOption</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">AttributeOptionPeer</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">RModuleAttribute</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">om</span></span>.<span class="mv">RModuleAttributePeer</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="add"><span class="mv"><span class="upd">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">services</span></span></span>.<span class="mv">module</span></span>.<span class="mv">ModuleEntity</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="add"><span class="mv">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">services</span></span>.<span class="mv">module</span></span>.<span class="mv">ModuleManager</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv"><span class="upd">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.<span class="mv">util</span></span></span>.<span class="mv">ScarabConstants</span></span>;</span><br/>
<span class="add">import <span class="add"><span class="mv"><span class="upd">org.<span class="mv">tigris</span>.<span class="mv">scarab</span>.util.<span class="mv">word</span></span></span>.<span class="mv">IssueSearch</span></span>;</span><br/>
<br/>
/**<br/>
 * This class is used by the Scarab API<br/>
 */<br/>
public class ScarabRequestTool implements ScarabRequestScope,<br/>
                                          Recyclable<br/>
{<br/>
    /** the object containing request specific data */<br/>
    private RunData data;<br/>
<br/>
    /**<br/>
     * A User object for use within the Scarab API.<br/>
     */<br/>
    private ScarabUser user = null;<br/>
<br/>
    /**<br/>
     * A Issue object for use within the Scarab API.<br/>
     */<br/>
    private Issue issue = null;<br/>
<br/>
    /**<br/>
     * A Attribute object for use within the Scarab API.<br/>
     */<br/>
    private Attribute attribute = null;<br/>
<br/>
    /**<br/>
     * A Attachment object for use within the Scarab API.<br/>
     */<br/>
    private Attachment attachment = null;<br/>
<br/>
    /**<br/>
     * A Depend object for use within the Scarab API.<br/>
     */<br/>
    private Depend depend = null;<br/>
<br/>
    /**<br/>
     * A Query object for use within the Scarab API.<br/>
     */<br/>
    private Query query = null;<br/>
<br/>
    /**<br/>
     * A ModuleEntity object for use within the Scarab API.<br/>
     */<br/>
    private ModuleEntity module = null;<br/>
<br/>
    /**<br/>
     * A AttributeOption object for use within the Scarab API.<br/>
     */<br/>
    private AttributeOption attributeOption = null;<br/>
    <br/>
    public void init(Object data)<br/>
    {<br/>
        this.data = (RunData)data;<br/>
    }<br/>
<br/>
    /**<br/>
     * nulls out the issue and user objects<br/>
     */<br/>
    public void refresh()<br/>
    {<br/>
        this.user = null;<br/>
        this.issue = null;<br/>
    }<br/>
<br/>
    /**<br/>
     * Constructor does initialization stuff<br/>
     */    <br/>
    public ScarabRequestTool()<br/>
    {<br/>
        //intake = new IntakeSystem();<br/>
    }<br/>
<br/>
    /**<br/>
     * A Attribute object for use within the Scarab API.<br/>
     */<br/>
    public void setAttribute (Attribute attribute)<br/>
    {<br/>
        this.attribute = attribute;<br/>
    }<br/>
<br/>
    /**<br/>
     * A Depend object for use within the Scarab API.<br/>
     */<br/>
    public void setDepend (Depend depend)<br/>
    {<br/>
        this.depend = depend;<br/>
    }<br/>
<br/>
    /**<br/>
     * A Query object for use within the Scarab API.<br/>
     */<br/>
    public void setQuery (Query query)<br/>
    {<br/>
        this.query = query;<br/>
    }<br/>
<br/>
    private IntakeTool getIntakeTool()<br/>
    {<br/>
        return (IntakeTool)Module.getTemplateContext(data)<br/>
            .get(ScarabConstants.INTAKE_TOOL);<br/>
    }<br/>
<br/>
<br/>
    /**<br/>
     * A Attribute object for use within the Scarab API.<br/>
     */<br/>
    public void setAttributeOption (AttributeOption option)<br/>
    {<br/>
        this.attributeOption = option;<br/>
    }<br/>
<br/>
    /**<br/>
     * A Attribute object for use within the Scarab API.<br/>
     */<br/>
    public AttributeOption getAttributeOption()<br/>
        throws Exception<br/>
    {<br/>
try{<br/>
        if (attributeOption == null)<br/>
        {<br/>
            String optId = data.getParameters()<br/>
                .getString("currentAttributeOption"); <br/>
            if ( optId == null )<br/>
            {<br/>
                attributeOption = new AttributeOption();                <br/>
            }<br/>
            else <br/>
            {<br/>
                attributeOption = AttributeOptionPeer<br/>
                    .retrieveByPK(new NumberKey(optId));<br/>
            }<br/>
        }<br/>
}catch(Exception e){e.printStackTrace();}<br/>
        return attributeOption;<br/>
    }<br/>
<br/>
    /**<br/>
     * A User object for use within the Scarab API.<br/>
     */<br/>
    public void setUser (ScarabUser user)<br/>
    {<br/>
        // this.user = user;<br/>
    }<br/>
<br/>
    /**<br/>
     * A User object for use within the Scarab API.<br/>
     */<br/>
    public ScarabUser getUser()<br/>
    {<br/>
        if (user == null)<br/>
        {<br/>
            this.user = (ScarabUser)data.getUser();<br/>
        }<br/>
        return (ScarabUser)data.getUser();<br/>
    }<br/>
<br/>
    /**<br/>
     * A User object for use within the Scarab API.<br/>
     */<br/>
    public ScarabUser getUser(String id)<br/>
     throws Exception<br/>
    {<br/>
        ScarabUser su = null;<br/>
        try<br/>
        {<br/>
            ObjectKey pk = (ObjectKey)new NumberKey(id);<br/>
            su = (ScarabUser)ScarabUserImplPeer.retrieveScarabUserImplByPK(pk);<br/>
        }<br/>
        <span class="mv">catch (<span class="mv">Exception e</span>)<br/>
        {<br/>
            <span class="mv">e</span>.printStackTrace();<br/>
        }</span><br/>
        return su;<br/>
    }<br/>
<br/>
    /**<br/>
     * A User object for use within the Scarab API.<br/>
     */<br/>
    public ScarabUser getUser(Integer id)<br/>
        throws Exception<br/>
    {<br/>
        return getUser(id.toString());<br/>
    }<br/>
<br/>
    /**<br/>
     * A Attribute object for use within the Scarab API.<br/>
     */<br/>
    public Attribute getAttribute()<br/>
     throws Exception<br/>
    {<br/>
try{<br/>
        if (attribute == null)<br/>
        {<br/>
            String attId = getIntakeTool()<br/>
                .get("Attribute", IntakeTool.DEFAULT_KEY).get("Id").toString();<br/>
            if ( attId == null || attId.length() == 0 )<br/>
            {<br/>
                attribute = Attribute.getInstance();<br/>
            }<br/>
            else <br/>
            {<br/>
                attribute = Attribute.getInstance(new NumberKey(attId));<br/>
            }<br/>
        }        <br/>
}<span class="mv">catch(<span class="mv">Exception e</span>){<span class="mv">e</span>.printStackTrace();}</span><br/>
        return attribute;<br/>
 <br/>
   }<br/>
<br/>
    /**<br/>
     * A Query object for use within the Scarab API.<br/>
     */<br/>
    public Query getQuery()<br/>
     throws Exception<br/>
    {<br/>
        try<br/>
        {<br/>
            if (query == null)<br/>
            {<br/>
                String queryId = getIntakeTool()<br/>
                    .get("Query", IntakeTool.DEFAULT_KEY).get("Id").toString();<br/>
                if ( queryId == null || queryId.length() == 0 )<br/>
                {<br/>
                    query = Query.getInstance();<br/>
                }<br/>
                else <br/>
                {<br/>
                    query = QueryPeer.retrieveByPK(new NumberKey(queryId));<br/>
                }<br/>
            }        <br/>
        }        <br/>
        <span class="mv">catch (<span class="mv">Exception e</span>)<br/>
        {<br/>
            <span class="mv">e</span>.printStackTrace();<br/>
        }</span><br/>
        return query;<br/>
 <br/>
   }<br/>
<br/>
    /**<br/>
     * A Depend object for use within the Scarab API.<br/>
     */<br/>
    public Depend getDepend()<br/>
     throws Exception<br/>
    {<br/>
        try<br/>
        {<br/>
            if (depend == null)<br/>
            {<br/>
                String dependId = getIntakeTool()<br/>
                    .get("Depend", IntakeTool.DEFAULT_KEY).get("Id").toString();<br/>
                if ( dependId == null || dependId.length() == 0 )<br/>
                {<br/>
                    depend = Depend.getInstance();<br/>
                }<br/>
                else <br/>
                {<br/>
                    depend = DependPeer.retrieveByPK(new NumberKey(dependId));<br/>
                }<br/>
            }        <br/>
        }        <br/>
        <span class="add">catch (<span class="mv">Exception e</span>)<br/>
        <span class="mv">{<br/>
            <span class="mv">e</span>.printStackTrace();<br/>
        }</span></span><br/>
        return depend;<br/>
 <br/>
   }<br/>
<br/>
    /**<br/>
     * A Attachment object for use within the Scarab API.<br/>
     */<br/>
    public Attachment getAttachment()<br/>
     throws Exception<br/>
    {<br/>
try{<br/>
        if (attachment == null)<br/>
        {<br/>
            Group att = getIntakeTool()<br/>
                .get("Attachment", IntakeTool.DEFAULT_KEY, false);<br/>
            if ( att != null ) <br/>
            {            <br/>
                String attId =  att.get("Id").toString();<br/>
                if ( attId == null || attId.length() == 0 )<br/>
                {<br/>
                    attachment = new Attachment();<br/>
                }<br/>
                else <br/>
                {<br/>
                    attachment = AttachmentPeer<br/>
                        .retrieveByPK(new NumberKey(attId));<br/>
                }<br/>
            }<br/>
            else <br/>
            {<br/>
                attachment = new Attachment();<br/>
            }<br/>
        }        <br/>
}catch(Exception e)<span class="mv">{<span class="mv">e</span>.printStackTrace(); <span class="mv">throw e;</span>}</span><br/>
        return attachment;<br/>
 <br/>
   }<br/>
<br/>
    /**<br/>
     * A Module object for use within the Scarab API.<br/>
     */<br/>
    public void setModule(ModuleEntity module)<br/>
    {<br/>
        this.module = module;<br/>
    }<br/>
<br/>
    /**<br/>
     * Get an Module object. <br/>
     *<br/>
     * @return a &lt;code&gt;ModuleEntity&lt;/code&gt; value<br/>
     */<br/>
    public ModuleEntity getModule()<br/>
     throws Exception<br/>
    {<br/>
      try{<br/>
            String modId = getIntakeTool()<br/>
                .get("Module", IntakeTool.DEFAULT_KEY).get("Id").toString();<br/>
            if ( modId == null || modId.length() == 0 )<br/>
            {<br/>
                module = ModuleManager.getInstance();<br/>
            }<br/>
            else <br/>
            {<br/>
                module = ModuleManager.getInstance(new NumberKey(modId));<br/>
            }<br/>
      }catch(Exception e)<span class="mv">{<span class="mv">e</span>.printStackTrace();}</span><br/>
        return module;<br/>
 <br/>
   }<br/>
    /**<br/>
     * Get an RModuleAttribute object. <br/>
     *<br/>
     * @return a &lt;code&gt;Module&lt;/code&gt; value<br/>
     */<br/>
    public RModuleAttribute getRModuleAttribute()<br/>
        throws Exception<br/>
    {<br/>
        RModuleAttribute rma = null;<br/>
      try{<br/>
            ComboKey rModAttId = (ComboKey)getIntakeTool()<br/>
                .get("RModuleAttribute", IntakeTool.DEFAULT_KEY)<br/>
                .get("Id").getValue();<br/>
            if ( rModAttId == null )<br/>
            {<br/>
                NumberKey attId = (NumberKey)getIntakeTool()<br/>
                    .get("Attribute", IntakeTool.DEFAULT_KEY)<br/>
                    .get("Id").getValue();<br/>
                if ( attId != null &amp;&amp; getUser().getCurrentModule() != null )<br/>
                {<br/>
                    NumberKey[] nka = {attId, <br/>
                        getUser().getCurrentModule().getModuleId()};<br/>
                    rma = RModuleAttributePeer.retrieveByPK(new ComboKey(nka));<br/>
                }<br/>
                else <br/>
                {<br/>
                    rma = new RModuleAttribute();<br/>
                }<br/>
            }<br/>
            else <br/>
            {<br/>
                rma = RModuleAttributePeer.retrieveByPK(rModAttId);<br/>
            }<br/>
      }catch(Exception e)<span class="add">{<span class="add"><span class="add"><span class="mv">e</span>.<span class="add">printStackTrace</span>()</span>;</span>}</span><br/>
        return rma;<br/>
 <br/>
   }<br/>
<br/>
    <br/>
<br/>
    /**<br/>
     * Get a specific module by key value.<br/>
     *<br/>
     * @param key a &lt;code&gt;String&lt;/code&gt; value<br/>
     * @return a &lt;code&gt;Module&lt;/code&gt; value<br/>
     */<br/>
    public ModuleEntity getModule(String key) throws Exception<br/>
    {<br/>
        return (ModuleEntity) ScarabModulePeer.retrieveByPK(new NumberKey(key));<br/>
    }<br/>
<br/>
<br/>
    /**<br/>
     * A Issue object for use within the Scarab API.<br/>
     */<br/>
    public void setIssue(Issue issue)<br/>
    {<br/>
        this.issue = issue;<br/>
    }<br/>
<br/>
    /**<br/>
     * Get an Issue object. If it is the first time calling,<br/>
     * it will be a new blank issue object.<br/>
     *<br/>
     * @return a &lt;code&gt;Issue&lt;/code&gt; value<br/>
     */<br/>
    public Issue getIssue()<br/>
        throws Exception<br/>
    {<br/>
        if (issue == null)<br/>
        {<br/>
            Group issueGroup = getIntakeTool()<br/>
                .get("Issue", IntakeTool.DEFAULT_KEY, false);<br/>
            if ( issueGroup != null ) <br/>
            {            <br/>
                String issueId =  issueGroup.get("Id").toString();<br/>
                if ( issueId == null || issueId.length() == 0 )<br/>
                {<br/>
                    issue = new Issue();<br/>
                }<br/>
                else <br/>
                {<br/>
                    issue = IssuePeer<br/>
                        .retrieveByPK(new NumberKey(issueId));<br/>
                }<br/>
            }<br/>
            else if ( data.getParameters().getString("issue_id") != null ) <br/>
            {                <br/>
                String issueId = data.getParameters().getString("issue_id");<br/>
                if ( issueId.length() == 0 )<br/>
                {<br/>
                    issue = new Issue();<br/>
                }<br/>
                else <br/>
                {<br/>
                    issue = IssuePeer<br/>
                        .retrieveByPK(new NumberKey(issueId));<br/>
                }<br/>
            }<br/>
            else <br/>
            {<br/>
                issue = new Issue();<br/>
            }<br/>
        }        <br/>
<br/>
        return issue;<br/>
    }<br/>
<br/>
    /**<br/>
     * Get a new SearchIssue object. <br/>
     *<br/>
     * @return a &lt;code&gt;Issue&lt;/code&gt; value<br/>
     */<br/>
    public IssueSearch getSearch()<br/>
        throws Exception<br/>
    {<br/>
        IssueSearch search = new IssueSearch();<br/>
        search.setModuleCast(((ScarabUser)getUser()).getCurrentModule());<br/>
        return search;<br/>
    }<br/>
<br/>
    /**<br/>
     * The id may be a primary key or an issue id.<br/>
     *<br/>
     * @param key a &lt;code&gt;String&lt;/code&gt; value<br/>
     * @return a &lt;code&gt;Issue&lt;/code&gt; value<br/>
     */<br/>
    public Issue getIssue(String key)<br/>
    {<br/>
        Issue issue = null;<br/>
        try<br/>
        {<br/>
            issue = IssuePeer.retrieveByPK(new NumberKey(key));<br/>
        }<br/>
        catch (Exception e)<br/>
        {<br/>
            // was not a primary key, try fid<br/>
            Issue.FederatedId fid = new Issue.FederatedId(key);<br/>
            if ( fid.getDomain() == null ) <br/>
            {<br/>
                // handle null (always null right now)<br/>
            }<br/>
            issue = Issue.getIssueById(fid);<br/>
        }<br/>
        return issue;<br/>
    }<br/>
<br/>
<br/>
<br/>
    // ****************** Recyclable implementation ************************<br/>
<br/>
    private boolean disposed;<br/>
<br/>
    /**<br/>
     * Recycles the object for a new client. Recycle methods with<br/>
     * parameters must be added to implementing object and they will be<br/>
     * automatically called by pool implementations when the object is<br/>
     * taken from the pool for a new client. The parameters must<br/>
     * correspond to the parameters of the constructors of the object.<br/>
     * For new objects, constructors can call their corresponding recycle<br/>
     * methods whenever applicable.<br/>
     * The recycle methods must call their super.<br/>
     */<br/>
    public void recycle()<br/>
    {<br/>
        disposed = false;<br/>
    }<br/>
<br/>
    /**<br/>
     * Disposes the object after use. The method is called<br/>
     * when the object is returned to its pool.<br/>
     * The dispose method must call its super.<br/>
     */<br/>
    public void dispose()<br/>
    {<br/>
        data = null;<br/>
        user = null;<br/>
        issue = null;<br/>
        attribute = null;<br/>
<br/>
        disposed = true;<br/>
    }<br/>
<br/>
    /**<br/>
     * Checks whether the recyclable has been disposed.<br/>
     * @return true, if the recyclable is disposed.<br/>
     */<br/>
    public boolean isDisposed()<br/>
    {<br/>
        return disposed;<br/>
    }<br/>
}<br/>
<br/>
<br/>
<br/>
</div>
</div>
</div>
<div class="clear"></div>
</div>
</body>
</html>