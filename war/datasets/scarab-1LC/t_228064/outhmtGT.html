<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>Diff result</title>
<style type="text/css">
body { width: 100%; font-size: 10pt; }
h1 { font-size: 125%; }
div.content { font-family: Verdana, "DejaVu Sans Condensed", "Liberation Sans","Nimbus Sans L", Helvetica, sans-serif; margin : 1em auto; width: 100%; }
div.left { float: left; width: 48%; padding: 1em; }
div.right { float: right; width: 48%; padding: 1em; }
div.code { font-family: "Liberation Mono", "Courrier New", monospace; border:1px solid black;}
div.clear { clear: both; }
span.del { background-color : red; font-weight: normal; font-style: normal;}
span.add { background-color : lightgreen; font-weight: bold; font-style: normal;}
span.upd { background-color : orange; font-weight: bold; font-style: italic;}
span.id { background-color : white; font-weight: normal; font-style: normal;}
span.mv { background-color : yellow; font-weight: normal; font-style: normal;}
</style></head><body><div class="content"><div class="left">
<h1>left_ModuleManager_1.21.java</h1>
<div class="code">
<div class="id">
<br/>
<br/>
package org.tigris.scarab.om;<br/>
<br/>
import java.util.List;<br/>
import java.util.LinkedList;<br/>
import java.util.ArrayList;<br/>
import java.util.Iterator;<br/>
import java.io.Serializable;<br/>
<br/>
import org.apache.torque.TorqueException;<br/>
import org.apache.torque.om.Persistent;<br/>
import org.apache.torque.om.ObjectKey;<br/>
import org.apache.torque.util.Criteria;<br/>
import org.apache.torque.manager.CacheListener;<br/>
<br/>
/** <br/>
 * This class manages Module objects.  <br/>
 * The skeleton for this class was autogenerated by Torque  <br/>
 * You should add additional methods to this class to meet the<br/>
 * application requirements.  This class will only be generated as<br/>
 * long as it does not already exist in the output directory.<br/>
 */<br/>
public class ModuleManager<br/>
    extends BaseModuleManager<br/>
    implements CacheListener<br/>
{<br/>
    /**<br/>
     * Creates a new &lt;code&gt;ModuleManager&lt;/code&gt; instance.<br/>
     *<br/>
     * @exception TorqueException if an error occurs<br/>
     */<br/>
    public ModuleManager()<br/>
        throws TorqueException<br/>
    {<br/>
        super();<br/>
        setRegion(getClassName().replace('.', '_'));<br/>
    }<br/>
<br/>
    protected Module getInstanceImpl()<br/>
    {<br/>
        return new ScarabModule();<br/>
    }<br/>
<br/>
    /**<br/>
     * Get an instance of a Module by realName and code. If the result<br/>
     * != 1, then throw a TorqueException.<br/>
     *<br/>
     * FIXME: Use caching? John?<br/>
     */<br/>
    public static Module getInstance(String moduleDomain, <br/>
                                     String moduleRealName, <br/>
                                     String moduleCode)<br/>
        throws TorqueException<br/>
    {<br/>
        return getManager().getInstanceImpl(moduleDomain, moduleRealName, <br/>
                                            moduleCode);<br/>
    }<br/>
<br/>
    /**<br/>
     * Get an instance of a Module by realName and code. If the result<br/>
     * != 1, then throw a TorqueException.<br/>
     *<br/>
     * FIXME: Use caching? John?<br/>
     */<br/>
    <span class="upd">public</span> Module getInstanceImpl(String moduleDomain, <br/>
                                  String moduleRealName, <br/>
                                  String moduleCode)<br/>
        throws TorqueException<br/>
    {<br/>
        Criteria crit = new Criteria();<br/>
        crit.add(ScarabModulePeer.MODULE_NAME, moduleDomain);<br/>
        crit.add(ScarabModulePeer.MODULE_NAME, moduleRealName);<br/>
        crit.add(ScarabModulePeer.MODULE_CODE, moduleCode);<br/>
        List result = ScarabModulePeer.doSelect(crit);<br/>
        if (result.size() != 1)<br/>
        {<br/>
            throw new TorqueException ("Selected: " + result.size() + <br/>
                " rows. Expected 1.");<br/>
        }<br/>
        return (Module) result.get(0);<br/>
    }<br/>
<br/>
    /**<br/>
     * Create a list of Modules from the given list of issues.  Each<br/>
     * Module in the list of issues will only occur once in the list of <br/>
     * Modules.<br/>
     *<br/>
     * @param issues a &lt;code&gt;List&lt;/code&gt; value<br/>
     * @return a &lt;code&gt;List&lt;/code&gt; value<br/>
     * @exception TorqueException if an error occurs<br/>
     */<br/>
    public static List getInstancesFromIssueList(List issues)<br/>
        throws TorqueException<br/>
    {<br/>
        if (issues == null) <br/>
        {<br/>
            throw new IllegalArgumentException("Null issue list is not allowed.");<br/>
        }        <br/>
<br/>
        List modules = new ArrayList();<br/>
        Iterator i = issues.iterator();<br/>
        if (i.hasNext()) <br/>
        {<br/>
            Issue issue = (Issue)i.next();<br/>
            if (issue != null)<br/>
            {<br/>
                Module module = issue.getModule();<br/>
                if (module != null &amp;&amp; !modules.contains(module)) <br/>
                {<br/>
                    modules.add(module);<br/>
                }<br/>
            }<br/>
            else<br/>
            {<br/>
                throw new TorqueException("Null issue in list is not allowed.");<br/>
            }<br/>
        }<br/>
        return modules;<br/>
    }<br/>
<br/>
<br/>
    /**<br/>
     * Notify other managers with relevant CacheEvents.<br/>
     */<br/>
    protected void registerAsListener()<br/>
    {<br/>
        RModuleIssueTypeManager.addCacheListener(this);<br/>
        RModuleAttributeManager.addCacheListener(this);<br/>
        AttributeGroupManager.addCacheListener(this);<br/>
        RModuleOptionManager.addCacheListener(this);<br/>
        AttributeManager.addCacheListener(this);<br/>
        AttributeOptionManager.addCacheListener(this);<br/>
    }<br/>
<br/>
    // -------------------------------------------------------------------<br/>
    // CacheListener implementation<br/>
<br/>
    public void addedObject(Persistent om)<br/>
    {<br/>
        if (om instanceof RModuleAttribute)<br/>
        {<br/>
            RModuleAttribute castom = (RModuleAttribute)om;<br/>
            ObjectKey key = castom.getModuleId();<br/>
            Serializable obj = (Serializable)cacheGet(key);<br/>
            if (obj != null) <br/>
            {<br/>
                getMethodResult().removeAll(obj, <br/>
                    AbstractScarabModule.GET_R_MODULE_ATTRIBUTES);<br/>
            }<br/>
        }<br/>
        else if (om instanceof RModuleOption)<br/>
        {<br/>
            RModuleOption castom = (RModuleOption)om;<br/>
            ObjectKey key = castom.getModuleId();<br/>
            Serializable obj = (Serializable)cacheGet(key);<br/>
            if (obj != null) <br/>
            {<br/>
                getMethodResult().removeAll(obj, <br/>
                    AbstractScarabModule.GET_LEAF_R_MODULE_OPTIONS);<br/>
            }<br/>
        }<br/>
        else if (om instanceof RModuleIssueType) <br/>
        {<br/>
            RModuleIssueType castom = (RModuleIssueType)om;<br/>
            ObjectKey key = castom.getModuleId();<br/>
            Serializable obj = (Serializable)cacheGet(key);<br/>
            if (obj != null) <br/>
            {<br/>
                getMethodResult().remove(obj, <br/>
                    AbstractScarabModule.GET_NAV_ISSUE_TYPES);<br/>
            }<br/>
        }<br/>
        else if (om instanceof AttributeGroup)<br/>
        {<br/>
            AttributeGroup castom = (AttributeGroup)om;<br/>
            ObjectKey key = castom.getModuleId();<br/>
            Serializable obj = (Serializable)cacheGet(key);<br/>
            if (obj != null) <br/>
            {<br/>
                getMethodResult().removeAll(obj, <br/>
                    AbstractScarabModule.GET_ATTRIBUTE_GROUPS);<br/>
            }<br/>
        }<br/>
        else if (om instanceof Attribute) <br/>
        {<br/>
            getMethodResult().clear();<br/>
        }<br/>
        else if (om instanceof AttributeOption) <br/>
        {<br/>
            getMethodResult().clear();<br/>
        }<br/>
    }<br/>
<br/>
    public void refreshedObject(Persistent om)<br/>
    {<br/>
        addedObject(om);<br/>
    }<br/>
<br/>
    /** fields which interest us with respect to cache events */<br/>
    public List getInterestedFields()<br/>
    {<br/>
        List interestedCacheFields = new LinkedList();<br/>
        interestedCacheFields.add(RModuleOptionPeer.MODULE_ID);<br/>
        interestedCacheFields.add(RModuleAttributePeer.MODULE_ID);<br/>
        interestedCacheFields.add(RModuleIssueTypePeer.MODULE_ID);<br/>
        interestedCacheFields.add(AttributeGroupPeer.MODULE_ID);<br/>
        interestedCacheFields.add(AttributePeer.ATTRIBUTE_ID);<br/>
        interestedCacheFields.add(AttributeOptionPeer.OPTION_ID);<br/>
        return interestedCacheFields;<br/>
    }<br/>
}<br/>
</div>
</div>
</div>
<div class="right">
<h1>right_ModuleManager_1.22.java</h1>
<div class="code">
<div class="id">
<br/>
<br/>
package org.tigris.scarab.om;<br/>
<br/>
import java.util.List;<br/>
import java.util.LinkedList;<br/>
import java.util.ArrayList;<br/>
import java.util.Iterator;<br/>
import java.io.Serializable;<br/>
<br/>
import org.apache.torque.TorqueException;<br/>
import org.apache.torque.om.Persistent;<br/>
import org.apache.torque.om.ObjectKey;<br/>
import org.apache.torque.util.Criteria;<br/>
import org.apache.torque.manager.CacheListener;<br/>
<br/>
/** <br/>
 * This class manages Module objects.  <br/>
 * The skeleton for this class was autogenerated by Torque  <br/>
 * You should add additional methods to this class to meet the<br/>
 * application requirements.  This class will only be generated as<br/>
 * long as it does not already exist in the output directory.<br/>
 */<br/>
public class ModuleManager<br/>
    extends BaseModuleManager<br/>
    implements CacheListener<br/>
{<br/>
    /**<br/>
     * Creates a new &lt;code&gt;ModuleManager&lt;/code&gt; instance.<br/>
     *<br/>
     * @exception TorqueException if an error occurs<br/>
     */<br/>
    public ModuleManager()<br/>
        throws TorqueException<br/>
    {<br/>
        super();<br/>
        setRegion(getClassName().replace('.', '_'));<br/>
    }<br/>
<br/>
    protected Module getInstanceImpl()<br/>
    {<br/>
        return new ScarabModule();<br/>
    }<br/>
<br/>
    /**<br/>
     * Get an instance of a Module by realName and code. If the result<br/>
     * != 1, then throw a TorqueException.<br/>
     *<br/>
     * FIXME: Use caching? John?<br/>
     */<br/>
    public static Module getInstance(String moduleDomain, <br/>
                                     String moduleRealName, <br/>
                                     String moduleCode)<br/>
        throws TorqueException<br/>
    {<br/>
        return getManager().getInstanceImpl(moduleDomain, moduleRealName, <br/>
                                            moduleCode);<br/>
    }<br/>
<br/>
    /**<br/>
     * Get an instance of a Module by realName and code. If the result<br/>
     * != 1, then throw a TorqueException.<br/>
     *<br/>
     * FIXME: Use caching? John?<br/>
     */<br/>
    <span class="upd">protected</span> Module getInstanceImpl(String moduleDomain, <br/>
                                     String moduleRealName, <br/>
                                     String moduleCode)<br/>
        throws TorqueException<br/>
    {<br/>
        Criteria crit = new Criteria();<br/>
        crit.add(ScarabModulePeer.MODULE_NAME, moduleDomain);<br/>
        crit.add(ScarabModulePeer.MODULE_NAME, moduleRealName);<br/>
        crit.add(ScarabModulePeer.MODULE_CODE, moduleCode);<br/>
        List result = ScarabModulePeer.doSelect(crit);<br/>
        if (result.size() != 1)<br/>
        {<br/>
            throw new TorqueException ("Selected: " + result.size() + <br/>
                " rows. Expected 1.");<br/>
        }<br/>
        return (Module) result.get(0);<br/>
    }<br/>
<br/>
    /**<br/>
     * Create a list of Modules from the given list of issues.  Each<br/>
     * Module in the list of issues will only occur once in the list of <br/>
     * Modules.<br/>
     *<br/>
     * @param issues a &lt;code&gt;List&lt;/code&gt; value<br/>
     * @return a &lt;code&gt;List&lt;/code&gt; value<br/>
     * @exception TorqueException if an error occurs<br/>
     */<br/>
    public static List getInstancesFromIssueList(List issues)<br/>
        throws TorqueException<br/>
    {<br/>
        if (issues == null) <br/>
        {<br/>
            throw new IllegalArgumentException("Null issue list is not allowed.");<br/>
        }        <br/>
<br/>
        List modules = new ArrayList();<br/>
        Iterator i = issues.iterator();<br/>
        if (i.hasNext()) <br/>
        {<br/>
            Issue issue = (Issue)i.next();<br/>
            if (issue != null)<br/>
            {<br/>
                Module module = issue.getModule();<br/>
                if (module != null &amp;&amp; !modules.contains(module)) <br/>
                {<br/>
                    modules.add(module);<br/>
                }<br/>
            }<br/>
            else<br/>
            {<br/>
                throw new TorqueException("Null issue in list is not allowed.");<br/>
            }<br/>
        }<br/>
        return modules;<br/>
    }<br/>
<br/>
<br/>
    /**<br/>
     * Notify other managers with relevant CacheEvents.<br/>
     */<br/>
    protected void registerAsListener()<br/>
    {<br/>
        RModuleIssueTypeManager.addCacheListener(this);<br/>
        RModuleAttributeManager.addCacheListener(this);<br/>
        AttributeGroupManager.addCacheListener(this);<br/>
        RModuleOptionManager.addCacheListener(this);<br/>
        AttributeManager.addCacheListener(this);<br/>
        AttributeOptionManager.addCacheListener(this);<br/>
    }<br/>
<br/>
    // -------------------------------------------------------------------<br/>
    // CacheListener implementation<br/>
<br/>
    public void addedObject(Persistent om)<br/>
    {<br/>
        if (om instanceof RModuleAttribute)<br/>
        {<br/>
            RModuleAttribute castom = (RModuleAttribute)om;<br/>
            ObjectKey key = castom.getModuleId();<br/>
            Serializable obj = (Serializable)cacheGet(key);<br/>
            if (obj != null) <br/>
            {<br/>
                getMethodResult().removeAll(obj, <br/>
                    AbstractScarabModule.GET_R_MODULE_ATTRIBUTES);<br/>
            }<br/>
        }<br/>
        else if (om instanceof RModuleOption)<br/>
        {<br/>
            RModuleOption castom = (RModuleOption)om;<br/>
            ObjectKey key = castom.getModuleId();<br/>
            Serializable obj = (Serializable)cacheGet(key);<br/>
            if (obj != null) <br/>
            {<br/>
                getMethodResult().removeAll(obj, <br/>
                    AbstractScarabModule.GET_LEAF_R_MODULE_OPTIONS);<br/>
            }<br/>
        }<br/>
        else if (om instanceof RModuleIssueType) <br/>
        {<br/>
            RModuleIssueType castom = (RModuleIssueType)om;<br/>
            ObjectKey key = castom.getModuleId();<br/>
            Serializable obj = (Serializable)cacheGet(key);<br/>
            if (obj != null) <br/>
            {<br/>
                getMethodResult().remove(obj, <br/>
                    AbstractScarabModule.GET_NAV_ISSUE_TYPES);<br/>
            }<br/>
        }<br/>
        else if (om instanceof AttributeGroup)<br/>
        {<br/>
            AttributeGroup castom = (AttributeGroup)om;<br/>
            ObjectKey key = castom.getModuleId();<br/>
            Serializable obj = (Serializable)cacheGet(key);<br/>
            if (obj != null) <br/>
            {<br/>
                getMethodResult().removeAll(obj, <br/>
                    AbstractScarabModule.GET_ATTRIBUTE_GROUPS);<br/>
            }<br/>
        }<br/>
        else if (om instanceof Attribute) <br/>
        {<br/>
            getMethodResult().clear();<br/>
        }<br/>
        else if (om instanceof AttributeOption) <br/>
        {<br/>
            getMethodResult().clear();<br/>
        }<br/>
    }<br/>
<br/>
    public void refreshedObject(Persistent om)<br/>
    {<br/>
        addedObject(om);<br/>
    }<br/>
<br/>
    /** fields which interest us with respect to cache events */<br/>
    public List getInterestedFields()<br/>
    {<br/>
        List interestedCacheFields = new LinkedList();<br/>
        interestedCacheFields.add(RModuleOptionPeer.MODULE_ID);<br/>
        interestedCacheFields.add(RModuleAttributePeer.MODULE_ID);<br/>
        interestedCacheFields.add(RModuleIssueTypePeer.MODULE_ID);<br/>
        interestedCacheFields.add(AttributeGroupPeer.MODULE_ID);<br/>
        interestedCacheFields.add(AttributePeer.ATTRIBUTE_ID);<br/>
        interestedCacheFields.add(AttributeOptionPeer.OPTION_ID);<br/>
        return interestedCacheFields;<br/>
    }<br/>
}<br/>
</div>
</div>
</div>
<div class="clear"></div>
</div>
</body>
</html>