<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>Diff result</title>
<style type="text/css">
body { width: 100%; font-size: 10pt; }
h1 { font-size: 125%; }
div.content { font-family: Verdana, "DejaVu Sans Condensed", "Liberation Sans","Nimbus Sans L", Helvetica, sans-serif; margin : 1em auto; width: 100%; }
div.left { float: left; width: 48%; padding: 1em; }
div.right { float: right; width: 48%; padding: 1em; }
div.code { font-family: "Liberation Mono", "Courrier New", monospace; border:1px solid black;}
div.clear { clear: both; }
span.del { background-color : red; font-weight: normal; font-style: normal;}
span.add { background-color : lightgreen; font-weight: bold; font-style: normal;}
span.upd { background-color : orange; font-weight: bold; font-style: italic;}
span.id { background-color : white; font-weight: normal; font-style: normal;}
span.mv { background-color : yellow; font-weight: normal; font-style: normal;}
</style></head><body><div class="content"><div class="left">
<h1>left_UseCasesHelperImpl_1.7.java</h1>
<div class="code">
<div class="id">
// $Id: UseCasesHelperImpl.java,v 1.7 2005-10-05 00:44:17 bobtarling Exp $<br/>
// Copyright (c) 1996-2005 The Regents of the University of California. All<br/>
// Rights Reserved. Permission to use, copy, modify, and distribute this<br/>
// software and its documentation without fee, and without a written<br/>
// agreement is hereby granted, provided that the above copyright notice<br/>
// and this paragraph appear in all copies.  This software program and<br/>
// documentation are copyrighted by The Regents of the University of<br/>
// California. The software program and documentation are supplied "AS<br/>
// IS", without any accompanying services from The Regents. The Regents<br/>
// does not warrant that the operation of the program will be<br/>
// uninterrupted or error-free. The end-user understands that the program<br/>
// was developed for research purposes and is advised not to rely<br/>
// exclusively on the program for any reason.  IN NO EVENT SHALL THE<br/>
// UNIVERSITY OF CALIFORNIA BE LIABLE TO ANY PARTY FOR DIRECT, INDIRECT,<br/>
// SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, INCLUDING LOST PROFITS,<br/>
// ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF<br/>
// THE UNIVERSITY OF CALIFORNIA HAS BEEN ADVISED OF THE POSSIBILITY OF<br/>
// SUCH DAMAGE. THE UNIVERSITY OF CALIFORNIA SPECIFICALLY DISCLAIMS ANY<br/>
// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF<br/>
// MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE SOFTWARE<br/>
// PROVIDED HEREUNDER IS ON AN "AS IS" BASIS, AND THE UNIVERSITY OF<br/>
// CALIFORNIA HAS NO OBLIGATIONS TO PROVIDE MAINTENANCE, SUPPORT,<br/>
// UPDATES, ENHANCEMENTS, OR MODIFICATIONS.<br/>
<br/>
package org.argouml.model.uml;<br/>
<br/>
import java.util.ArrayList;<br/>
import java.util.Collection;<br/>
import java.util.HashSet;<br/>
import java.util.Iterator;<br/>
import java.util.List;<br/>
import java.util.Set;<br/>
<br/>
import org.argouml.model.UseCasesHelper;<br/>
<br/>
import ru.novosoft.uml.MBase;<br/>
import ru.novosoft.uml.behavior.use_cases.MActor;<br/>
import ru.novosoft.uml.behavior.use_cases.MExtend;<br/>
import ru.novosoft.uml.behavior.use_cases.MExtensionPoint;<br/>
import ru.novosoft.uml.behavior.use_cases.MInclude;<br/>
import ru.novosoft.uml.behavior.use_cases.MUseCase;<br/>
import ru.novosoft.uml.foundation.core.MClass;<br/>
import ru.novosoft.uml.foundation.core.MNamespace;<br/>
import ru.novosoft.uml.foundation.data_types.MBooleanExpression;<br/>
import ru.novosoft.uml.model_management.MSubsystem;<br/>
<br/>
/**<br/>
 * Helper class for UML BehavioralElements::UseCases Package.<br/>
 *<br/>
 * Current implementation is a placeholder.<br/>
 *<br/>
 * @since ARGO0.11.2<br/>
 * @author Thierry Lach<br/>
 */<br/>
class UseCasesHelperImpl implements UseCasesHelper {<br/>
<br/>
    /**<br/>
     * The model implementation.<br/>
     */<br/>
    private NSUMLModelImplementation nsmodel;<br/>
<br/>
    /**<br/>
     * Don't allow instantiation.<br/>
     *<br/>
     * @param implementation To get other helpers and factories.<br/>
     */<br/>
    UseCasesHelperImpl(NSUMLModelImplementation implementation) {<br/>
        nsmodel = implementation;<br/>
    }<br/>
<br/>
    /**<br/>
     * This method returns all extension points of a given use case.&lt;p&gt;<br/>
     *<br/>
     * Here for completeness, but actually just a wrapper for the NSUML<br/>
     * function.&lt;p&gt;<br/>
     *<br/>
     * @param useCase  The use case for which we want the extension points.<br/>
     *<br/>
     * @return         A collection of the extension points.<br/>
     */<br/>
    public Collection getExtensionPoints(Object/*MUseCase*/ useCase) {<br/>
<br/>
        return ((MUseCase) useCase).getExtensionPoints();<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns all usecases in some namespace ns.<br/>
     *<br/>
     * @param ns is the namespace<br/>
     * @return Collection<br/>
     */<br/>
    public Collection getAllUseCases(Object ns) {<br/>
        if (!(ns instanceof MNamespace)) {<br/>
            throw new IllegalArgumentException();<br/>
        }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = ((MNamespace) ns).getOwnedElements().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;List list = new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    Object o = it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (o instanceof MNamespace) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.addAll(getAllUseCases(o));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (o instanceof MUseCase) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(o);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return list;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns all actors in some namespace ns.<br/>
     *<br/>
     * @param ns is the namespace<br/>
     * @return Collection<br/>
     */<br/>
    public Collection getAllActors(Object ns) {<br/>
        if (!(ns instanceof MNamespace)) {<br/>
            throw new IllegalArgumentException();<br/>
        }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = ((MNamespace) ns).getOwnedElements().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;List list = new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    Object o = it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (o instanceof MNamespace) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.addAll(getAllActors(o));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (o instanceof MActor) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(o);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return list;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns all usecases this given usecase extends.&lt;p&gt;<br/>
     *<br/>
     * @param ausecase the given usecase<br/>
     * @return Collection all usecases this given usecase extends<br/>
     */<br/>
    public Collection getExtendedUseCases(Object ausecase) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;if (ausecase == null) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    return new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
        MUseCase usecase = (MUseCase) ausecase;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = usecase.getExtends().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;List list = new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MExtend extend = (MExtend) it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MUseCase base = extend.getBase();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    list.add(base);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return list;<br/>
    }<br/>
<br/>
    /**<br/>
     * @param usecase the given usecase<br/>
     * @return Collection all usecases that extend the given usecase<br/>
     */<br/>
    public Collection getExtendingUseCases(Object usecase) {<br/>
        if (usecase == null) {<br/>
            return new ArrayList();<br/>
        }<br/>
        Iterator it = ((MUseCase) usecase).getExtends2().iterator();<br/>
        List list = new ArrayList();<br/>
        while (it.hasNext()) {<br/>
            MExtend ext = (MExtend) it.next();<br/>
            MUseCase extension = ext.getExtension();<br/>
            list.add(extension);<br/>
        }<br/>
        return list;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns the extend relation between two usecases base and<br/>
     * extension. If there is none null is returned.<br/>
     *<br/>
     * @param abase the given base usecase<br/>
     * @param anextension the given extension usecase<br/>
     * @return MExtend the extend relation<br/>
     */<br/>
    public Object getExtends(Object/*MUseCase*/ abase,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     Object/*MUseCase*/ anextension) {<br/>
        MUseCase base = (MUseCase) abase;<br/>
        MUseCase extension = (MUseCase) anextension;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;if (base == null || extension == null) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    return null;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = extension.getExtends().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MExtend extend = (MExtend) it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (extend.getBase() == base) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return extend;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return null;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns all usecases this usecase includes.<br/>
     *<br/>
     * @param ausecase the given usecase<br/>
     * @return Collection all usecases the given usecase includes<br/>
     */<br/>
    public Collection getIncludedUseCases(Object/*MUseCase*/ ausecase) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;if (ausecase == null) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    return new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
        MUseCase usecase = (MUseCase) ausecase;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = usecase.getIncludes().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;List list = new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MInclude include = (MInclude) it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MUseCase addition = include.getBase();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    list.add(addition);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return list;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns the include relation between two usecases base and<br/>
     * inclusion. If there is none null is returned.<br/>
     *<br/>
     * @param abase the given base usecase<br/>
     * @param aninclusion the given inclusion usecase<br/>
     * @return MExtend the include relation<br/>
     */<br/>
    public Object getIncludes(Object abase, Object aninclusion) {<br/>
        MUseCase base = (MUseCase) abase;<br/>
        MUseCase inclusion = (MUseCase) aninclusion;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;if (base == null || inclusion == null) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    return null;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = inclusion.getIncludes().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MInclude include = (MInclude) it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (include.getBase() == base) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return include;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return null;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns the specificationpath operation of some usecase. See<br/>
     * section 2.11.3.5 of the UML 1.3 spec for a definition.&lt;p&gt;<br/>
     *<br/>
     * @param ausecase the given usecase<br/>
     * @return Collection the specificationpath operation of the given usecase<br/>
     */<br/>
    public Collection getSpecificationPath(Object ausecase) {<br/>
        MUseCase uc = (MUseCase) ausecase;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Set set = new HashSet();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;set.addAll(nsmodel.getModelManagementHelper()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   .getAllSurroundingNamespaces(uc));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Set set2 = new HashSet();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = set.iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    Object o = it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (o instanceof MSubsystem || o instanceof MClass) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set2.add(o);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return set2;<br/>
    }<br/>
<br/>
    /**<br/>
     * Sets the base usecase of a given extend. Updates the<br/>
     * extensionpoints of the extend too.<br/>
     *<br/>
     * @param extend the given extend<br/>
     * @param base the base usecase<br/>
     */<br/>
    public void setBase(Object extend, Object base) {<br/>
        if (base == null) {<br/>
            throw new IllegalArgumentException(<br/>
                    "The base cannot be null");<br/>
        }<br/>
        <br/>
        if (!(base instanceof MUseCase)) {<br/>
            throw new IllegalArgumentException(<br/>
                    "The base cannot be a " + base.getClass().getName());<br/>
        }<br/>
<br/>
<br/>
        if (extend == null) {<br/>
            throw new IllegalArgumentException("extend");<br/>
        }<br/>
<br/>
        if (extend instanceof MExtend) {<br/>
            MExtend theExtend = ((MExtend) extend);<br/>
            if (base == theExtend.getBase()) {<br/>
                return;<br/>
            }<br/>
            Iterator it = theExtend.getExtensionPoints().iterator();<br/>
            while (it.hasNext()) {<br/>
                MExtensionPoint point = (MExtensionPoint) it.next();<br/>
                point.removeExtend(theExtend);<br/>
            }<br/>
            MExtensionPoint point =<br/>
                (MExtensionPoint)<br/>
                nsmodel.getUseCasesFactory().buildExtensionPoint(base);<br/>
            theExtend.setBase((MUseCase) base);<br/>
            theExtend.addExtensionPoint(point);<br/>
        } else  if (extend instanceof MInclude) {<br/>
            MInclude theInclude = ((MInclude) extend);<br/>
            if (base == theInclude.getBase()) {<br/>
                return;<br/>
            }<br/>
            theInclude.setAddition((MUseCase) base);<br/>
        } else {<br/>
            throw new IllegalArgumentException();<br/>
        }<br/>
    }<br/>
<br/>
    /**<br/>
     * Remove an extend to a Use Case or Extension Point.<br/>
     *<br/>
     * @param elem The Use Case or Extension Point.<br/>
     * @param extend The Extend to add.<br/>
     */<br/>
    public void removeExtend(Object elem, Object extend) {<br/>
        if (elem instanceof MUseCase<br/>
                &amp;&amp; extend instanceof MExtend) {<br/>
            ((MUseCase) elem).removeExtend((MExtend) extend);<br/>
            return;<br/>
        }<br/>
        if (elem instanceof MExtensionPoint<br/>
                &amp;&amp; extend instanceof MExtend) {<br/>
            ((MExtensionPoint) elem).removeExtend((MExtend) extend);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("elem: " + elem<br/>
                + " or extend: " + extend);<br/>
    }<br/>
<br/>
    /**<br/>
     * This method removes an Extension Point from a Use Case or an Extend.<br/>
     *<br/>
     * @param elem is The Use Case or Extend.<br/>
     * @param ep is the extension point<br/>
     */<br/>
    public void removeExtensionPoint(Object elem, Object ep) {<br/>
        if (elem instanceof MUseCase<br/>
                &amp;&amp; ep instanceof MExtensionPoint) {<br/>
            ((MUseCase) elem).removeExtensionPoint((MExtensionPoint) ep);<br/>
            return;<br/>
        }<br/>
        if (elem instanceof MExtend<br/>
                &amp;&amp; ep instanceof MExtensionPoint) {<br/>
            ((MExtend) elem).removeExtensionPoint((MExtensionPoint) ep);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("elem: " + elem + " or ep: " + ep);<br/>
    }<br/>
<br/>
    /**<br/>
     * Remove an include from a Use Case.<br/>
     *<br/>
     * @param usecase The Use Case.<br/>
     * @param include The Include.<br/>
     */<br/>
    public void removeInclude(Object usecase, Object include) {<br/>
        if (usecase instanceof MUseCase<br/>
                &amp;&amp; include instanceof MInclude) {<br/>
            ((MUseCase) usecase).removeInclude((MInclude) include);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("usecase: " + usecase<br/>
                + " or include: " + include);<br/>
    }<br/>
<br/>
    /**<br/>
     * Add an extend to a Use Case or Extension Point.<br/>
     *<br/>
     * @param elem The Use Case or Extension Point.<br/>
     * @param extend The Extend to add.<br/>
     */<br/>
    public void addExtend(Object elem, Object extend) {<br/>
        if (elem instanceof MUseCase<br/>
                &amp;&amp; extend instanceof MExtend) {<br/>
            ((MUseCase) elem).addExtend((MExtend) extend);<br/>
            return;<br/>
        }<br/>
        if (elem instanceof MExtensionPoint<br/>
                &amp;&amp; extend instanceof MExtend) {<br/>
            ((MExtensionPoint) elem).addExtend((MExtend) extend);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("elem: " + elem<br/>
                + " or extend: " + extend);<br/>
    }<br/>
<br/>
    /**<br/>
     * Adds an extension point to some model element.<br/>
     *<br/>
     * @param handle is the model element<br/>
     * @param extensionPoint is the extension point<br/>
     */<br/>
    public void addExtensionPoint(<br/>
            Object handle,<br/>
            Object extensionPoint) {<br/>
        if (extensionPoint instanceof MExtensionPoint) {<br/>
            if (handle instanceof MUseCase) {<br/>
                ((MUseCase) handle).addExtensionPoint(<br/>
                        (MExtensionPoint) extensionPoint);<br/>
                return;<br/>
            }<br/>
            if (handle instanceof MExtend) {<br/>
                ((MExtend) handle).addExtensionPoint(<br/>
                        (MExtensionPoint) extensionPoint);<br/>
                return;<br/>
            }<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle<br/>
                + " or extensionPoint: " + extensionPoint);<br/>
    }<br/>
<br/>
    /**<br/>
     * Add an include to a Use Case.<br/>
     *<br/>
     * @param usecase The Use Case.<br/>
     * @param include The Include.<br/>
     */<br/>
    public void addInclude(Object usecase, Object include) {<br/>
        if (usecase instanceof MUseCase<br/>
                &amp;&amp; include instanceof MInclude) {<br/>
            ((MUseCase) usecase).addInclude((MInclude) include);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("usecase: " + usecase<br/>
                + " or include: " + include);<br/>
    }<br/>
<br/>
    /**<br/>
     * Sets the addition to an include.<br/>
     * There is a bug in NSUML that reverses additions and bases for includes.<br/>
     *<br/>
     * @param handle Include<br/>
     * @param useCase UseCase<br/>
     */<br/>
    public void setAddition(Object handle, Object useCase) {<br/>
        if ((handle instanceof MBase) &amp;&amp; ((MBase) handle).isRemoved()) {<br/>
            throw new IllegalArgumentException("Operation on a removed object ["<br/>
                    + handle + "]");<br/>
        }<br/>
        if ((useCase instanceof MBase) &amp;&amp; ((MBase) useCase).isRemoved()) {<br/>
            throw new IllegalArgumentException("Operation on a removed object ["<br/>
                    + useCase + "]");<br/>
        }<br/>
<br/>
        if (<span class="mv">handle instanceof MInclude</span>) {<br/>
            ((MInclude) handle).setBase(<span class="del">(<span class="mv">MUseCase</span>) <span class="mv">useCase</span></span>);<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle);<br/>
    }<br/>
<br/>
    /**<br/>
     * Set the condition of an extend.<br/>
     *<br/>
     * @param handle is the extend<br/>
     * @param booleanExpression is the condition<br/>
     */<br/>
    public void setCondition(Object handle, Object booleanExpression) {<br/>
        if (handle instanceof MExtend<br/>
                &amp;&amp; booleanExpression instanceof MBooleanExpression) {<br/>
            ((MExtend) handle).setCondition(<br/>
                    (MBooleanExpression) booleanExpression);<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle<br/>
                + " or booleanExpression: " + booleanExpression);<br/>
    }<br/>
<br/>
    /**<br/>
     * Set the extension of a usecase.<br/>
     *<br/>
     * @param extend Extend<br/>
     * @param useCase UseCase<br/>
     */<br/>
    public void setExtension(Object extend, Object <span class="mv">useCase</span>) {<br/>
        if (<span class="del">!<span class="del">(<span class="del"><span class="mv">useCase</span> instanceof <span class="mv">MUseCase</span></span>)</span></span>) {<br/>
            throw new IllegalArgumentException("A use case must be supplied");<br/>
        }<br/>
        <br/>
        if ((extend instanceof MBase) &amp;&amp; ((MBase) extend).isRemoved()) {<br/>
            throw new IllegalStateException("Operation on a removed object ["<br/>
                    + extend + "]");<br/>
        }<br/>
        if ((<span class="mv">useCase</span> instanceof MBase) &amp;&amp; ((MBase) <span class="mv">useCase</span>).isRemoved()) {<br/>
            throw new IllegalStateException("Operation on a removed object ["<br/>
                    + <span class="mv">useCase</span> + "]");<br/>
        }<br/>
<br/>
        if (extend instanceof MExtend<br/>
                &amp;&amp; <span class="mv">(<span class="mv">useCase</span> instanceof MUseCase)</span>) {<br/>
            ((MExtend) extend).setExtension(<span class="del">(<span class="mv">MUseCase</span>) <span class="mv">useCase</span></span>);<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + extend<br/>
                + " or ext: " + <span class="mv">useCase</span>);<br/>
    }<br/>
<br/>
    /**<br/>
     * Sets the extension points of some use cases or extend relationships.<br/>
     *<br/>
     * @param handle the use case or extend relationship<br/>
     * @param extensionPoints is the extension points<br/>
     */<br/>
    public void setExtensionPoints(<br/>
            Object handle,<br/>
            Collection extensionPoints) {<br/>
        if (<span class="del"><span class="mv">handle</span> instanceof <span class="mv">MUseCase</span></span> &amp;&amp; extensionPoints instanceof List) {<br/>
            <span class="del">(<span class="del">(<span class="mv">MUseCase</span>) <span class="mv">handle</span></span>)</span>.setExtensionPoints(extensionPoints);<br/>
            return;<br/>
        }<br/>
        if (handle instanceof MExtend &amp;&amp; extensionPoints instanceof Collection) {<br/>
            ((MExtend) handle).setExtensionPoints(new ArrayList(extensionPoints));<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle<br/>
                + " or extensionPoints: " + extensionPoints.getClass());<br/>
    }<br/>
<br/>
    /**<br/>
     * Set the collection of Include relationships for a usecase.<br/>
     *<br/>
     * @param handle UseCase<br/>
     * @param includes the collection of Include relationships<br/>
     */<br/>
    public void setIncludes(Object handle, Collection includes) {<br/>
        if (<span class="del"><span class="mv">handle</span> instanceof <span class="mv">MUseCase</span></span>) {<br/>
            <span class="del">(<span class="del">(<span class="mv">MUseCase</span>) <span class="mv">handle</span></span>)</span>.setIncludes(includes);<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle<br/>
                + " or includes: " + includes);<br/>
    }<br/>
<br/>
    /**<br/>
     * Sets a location of some extension point.<br/>
     *<br/>
     * @param handle is the extension point<br/>
     * @param loc is the location<br/>
     */<br/>
    public void setLocation(Object handle, String loc) {<br/>
        if (handle instanceof MExtensionPoint) {<br/>
            ((MExtensionPoint) handle).setLocation(loc);<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle);<br/>
    }<br/>
<br/>
    /**<br/>
     * Set a Use Case for an Extension Point.<br/>
     *<br/>
     * @param elem The Extension Point.<br/>
     * @param usecase The Use Case.<br/>
     */<br/>
    public void setUseCase(Object elem, Object usecase) {<br/>
        if (elem instanceof MExtensionPoint<br/>
                &amp;&amp; (<span class="del"><span class="mv">usecase</span> instanceof <span class="mv">MUseCase</span></span><br/>
                        || usecase == null)) {<br/>
            ((MExtensionPoint) elem).setUseCase(<span class="del">(<span class="mv">MUseCase</span>) <span class="mv">usecase</span></span>);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("elem: " + elem<br/>
                + " or usecase: " + usecase);<br/>
    }<br/>
}<br/>
</div>
</div>
</div>
<div class="right">
<h1>right_UseCasesHelperImpl_1.8.java</h1>
<div class="code">
<div class="id">
// $Id: UseCasesHelperImpl.java,v 1.8 2005-10-05 15:47:35 bobtarling Exp $<br/>
// Copyright (c) 1996-2005 The Regents of the University of California. All<br/>
// Rights Reserved. Permission to use, copy, modify, and distribute this<br/>
// software and its documentation without fee, and without a written<br/>
// agreement is hereby granted, provided that the above copyright notice<br/>
// and this paragraph appear in all copies.  This software program and<br/>
// documentation are copyrighted by The Regents of the University of<br/>
// California. The software program and documentation are supplied "AS<br/>
// IS", without any accompanying services from The Regents. The Regents<br/>
// does not warrant that the operation of the program will be<br/>
// uninterrupted or error-free. The end-user understands that the program<br/>
// was developed for research purposes and is advised not to rely<br/>
// exclusively on the program for any reason.  IN NO EVENT SHALL THE<br/>
// UNIVERSITY OF CALIFORNIA BE LIABLE TO ANY PARTY FOR DIRECT, INDIRECT,<br/>
// SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, INCLUDING LOST PROFITS,<br/>
// ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF<br/>
// THE UNIVERSITY OF CALIFORNIA HAS BEEN ADVISED OF THE POSSIBILITY OF<br/>
// SUCH DAMAGE. THE UNIVERSITY OF CALIFORNIA SPECIFICALLY DISCLAIMS ANY<br/>
// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF<br/>
// MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE SOFTWARE<br/>
// PROVIDED HEREUNDER IS ON AN "AS IS" BASIS, AND THE UNIVERSITY OF<br/>
// CALIFORNIA HAS NO OBLIGATIONS TO PROVIDE MAINTENANCE, SUPPORT,<br/>
// UPDATES, ENHANCEMENTS, OR MODIFICATIONS.<br/>
<br/>
package org.argouml.model.uml;<br/>
<br/>
import java.util.ArrayList;<br/>
import java.util.Collection;<br/>
import java.util.HashSet;<br/>
import java.util.Iterator;<br/>
import java.util.List;<br/>
import java.util.Set;<br/>
<br/>
import org.argouml.model.UseCasesHelper;<br/>
<br/>
import ru.novosoft.uml.MBase;<br/>
import ru.novosoft.uml.behavior.use_cases.MActor;<br/>
import ru.novosoft.uml.behavior.use_cases.MExtend;<br/>
import ru.novosoft.uml.behavior.use_cases.MExtensionPoint;<br/>
import ru.novosoft.uml.behavior.use_cases.MInclude;<br/>
import ru.novosoft.uml.behavior.use_cases.MUseCase;<br/>
import ru.novosoft.uml.foundation.core.MClass;<br/>
import ru.novosoft.uml.foundation.core.MNamespace;<br/>
import ru.novosoft.uml.foundation.data_types.MBooleanExpression;<br/>
import ru.novosoft.uml.model_management.MSubsystem;<br/>
<br/>
/**<br/>
 * Helper class for UML BehavioralElements::UseCases Package.<br/>
 *<br/>
 * Current implementation is a placeholder.<br/>
 *<br/>
 * @since ARGO0.11.2<br/>
 * @author Thierry Lach<br/>
 */<br/>
class UseCasesHelperImpl implements UseCasesHelper {<br/>
<br/>
    /**<br/>
     * The model implementation.<br/>
     */<br/>
    private NSUMLModelImplementation nsmodel;<br/>
<br/>
    /**<br/>
     * Don't allow instantiation.<br/>
     *<br/>
     * @param implementation To get other helpers and factories.<br/>
     */<br/>
    UseCasesHelperImpl(NSUMLModelImplementation implementation) {<br/>
        nsmodel = implementation;<br/>
    }<br/>
<br/>
    /**<br/>
     * This method returns all extension points of a given use case.&lt;p&gt;<br/>
     *<br/>
     * Here for completeness, but actually just a wrapper for the NSUML<br/>
     * function.&lt;p&gt;<br/>
     *<br/>
     * @param useCase  The use case for which we want the extension points.<br/>
     *<br/>
     * @return         A collection of the extension points.<br/>
     */<br/>
    public Collection getExtensionPoints(Object/*MUseCase*/ useCase) {<br/>
<br/>
        return ((MUseCase) useCase).getExtensionPoints();<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns all usecases in some namespace ns.<br/>
     *<br/>
     * @param ns is the namespace<br/>
     * @return Collection<br/>
     */<br/>
    public Collection getAllUseCases(Object ns) {<br/>
        if (!(ns instanceof MNamespace)) {<br/>
            throw new IllegalArgumentException();<br/>
        }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = ((MNamespace) ns).getOwnedElements().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;List list = new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    Object o = it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (o instanceof MNamespace) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.addAll(getAllUseCases(o));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (o instanceof MUseCase) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(o);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return list;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns all actors in some namespace ns.<br/>
     *<br/>
     * @param ns is the namespace<br/>
     * @return Collection<br/>
     */<br/>
    public Collection getAllActors(Object ns) {<br/>
        if (!(ns instanceof MNamespace)) {<br/>
            throw new IllegalArgumentException();<br/>
        }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = ((MNamespace) ns).getOwnedElements().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;List list = new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    Object o = it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (o instanceof MNamespace) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.addAll(getAllActors(o));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (o instanceof MActor) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;list.add(o);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return list;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns all usecases this given usecase extends.&lt;p&gt;<br/>
     *<br/>
     * @param ausecase the given usecase<br/>
     * @return Collection all usecases this given usecase extends<br/>
     */<br/>
    public Collection getExtendedUseCases(Object ausecase) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;if (ausecase == null) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    return new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
        MUseCase usecase = (MUseCase) ausecase;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = usecase.getExtends().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;List list = new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MExtend extend = (MExtend) it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MUseCase base = extend.getBase();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    list.add(base);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return list;<br/>
    }<br/>
<br/>
    /**<br/>
     * @param usecase the given usecase<br/>
     * @return Collection all usecases that extend the given usecase<br/>
     */<br/>
    public Collection getExtendingUseCases(Object usecase) {<br/>
        if (usecase == null) {<br/>
            return new ArrayList();<br/>
        }<br/>
        Iterator it = ((MUseCase) usecase).getExtends2().iterator();<br/>
        List list = new ArrayList();<br/>
        while (it.hasNext()) {<br/>
            MExtend ext = (MExtend) it.next();<br/>
            MUseCase extension = ext.getExtension();<br/>
            list.add(extension);<br/>
        }<br/>
        return list;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns the extend relation between two usecases base and<br/>
     * extension. If there is none null is returned.<br/>
     *<br/>
     * @param abase the given base usecase<br/>
     * @param anextension the given extension usecase<br/>
     * @return MExtend the extend relation<br/>
     */<br/>
    public Object getExtends(Object/*MUseCase*/ abase,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     Object/*MUseCase*/ anextension) {<br/>
        MUseCase base = (MUseCase) abase;<br/>
        MUseCase extension = (MUseCase) anextension;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;if (base == null || extension == null) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    return null;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = extension.getExtends().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MExtend extend = (MExtend) it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (extend.getBase() == base) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return extend;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return null;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns all usecases this usecase includes.<br/>
     *<br/>
     * @param ausecase the given usecase<br/>
     * @return Collection all usecases the given usecase includes<br/>
     */<br/>
    public Collection getIncludedUseCases(Object/*MUseCase*/ ausecase) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;if (ausecase == null) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    return new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
        MUseCase usecase = (MUseCase) ausecase;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = usecase.getIncludes().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;List list = new ArrayList();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MInclude include = (MInclude) it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MUseCase addition = include.getBase();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    list.add(addition);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return list;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns the include relation between two usecases base and<br/>
     * inclusion. If there is none null is returned.<br/>
     *<br/>
     * @param abase the given base usecase<br/>
     * @param aninclusion the given inclusion usecase<br/>
     * @return MExtend the include relation<br/>
     */<br/>
    public Object getIncludes(Object abase, Object aninclusion) {<br/>
        MUseCase base = (MUseCase) abase;<br/>
        MUseCase inclusion = (MUseCase) aninclusion;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;if (base == null || inclusion == null) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    return null;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = inclusion.getIncludes().iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    MInclude include = (MInclude) it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (include.getBase() == base) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return include;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return null;<br/>
    }<br/>
<br/>
    /**<br/>
     * Returns the specificationpath operation of some usecase. See<br/>
     * section 2.11.3.5 of the UML 1.3 spec for a definition.&lt;p&gt;<br/>
     *<br/>
     * @param ausecase the given usecase<br/>
     * @return Collection the specificationpath operation of the given usecase<br/>
     */<br/>
    public Collection getSpecificationPath(Object ausecase) {<br/>
        MUseCase uc = (MUseCase) ausecase;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Set set = new HashSet();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;set.addAll(nsmodel.getModelManagementHelper()<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   .getAllSurroundingNamespaces(uc));<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Set set2 = new HashSet();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;Iterator it = set.iterator();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;while (it.hasNext()) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    Object o = it.next();<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    if (o instanceof MSubsystem || o instanceof MClass) {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set2.add(o);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;    }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;return set2;<br/>
    }<br/>
<br/>
    /**<br/>
     * Sets the base usecase of a given extend. Updates the<br/>
     * extensionpoints of the extend too.<br/>
     *<br/>
     * @param extend the given extend<br/>
     * @param base the base usecase<br/>
     */<br/>
    public void setBase(Object extend, Object base) {<br/>
        if (base == null) {<br/>
            throw new IllegalArgumentException(<br/>
                    "The base cannot be null");<br/>
        }<br/>
        <br/>
        if (!(base instanceof MUseCase)) {<br/>
            throw new IllegalArgumentException(<br/>
                    "The base cannot be a " + base.getClass().getName());<br/>
        }<br/>
<br/>
<br/>
        if (extend == null) {<br/>
            throw new IllegalArgumentException("extend");<br/>
        }<br/>
<br/>
        if (extend instanceof MExtend) {<br/>
            MExtend theExtend = ((MExtend) extend);<br/>
            if (base == theExtend.getBase()) {<br/>
                return;<br/>
            }<br/>
            Iterator it = theExtend.getExtensionPoints().iterator();<br/>
            while (it.hasNext()) {<br/>
                MExtensionPoint point = (MExtensionPoint) it.next();<br/>
                point.removeExtend(theExtend);<br/>
            }<br/>
            MExtensionPoint point =<br/>
                (MExtensionPoint)<br/>
                nsmodel.getUseCasesFactory().buildExtensionPoint(base);<br/>
            theExtend.setBase((MUseCase) base);<br/>
            theExtend.addExtensionPoint(point);<br/>
        } else  if (extend instanceof MInclude) {<br/>
            MInclude theInclude = ((MInclude) extend);<br/>
            if (base == theInclude.getBase()) {<br/>
                return;<br/>
            }<br/>
            theInclude.setAddition((MUseCase) base);<br/>
        } else {<br/>
            throw new IllegalArgumentException();<br/>
        }<br/>
    }<br/>
<br/>
    /**<br/>
     * Remove an extend to a Use Case or Extension Point.<br/>
     *<br/>
     * @param elem The Use Case or Extension Point.<br/>
     * @param extend The Extend to add.<br/>
     */<br/>
    public void removeExtend(Object elem, Object extend) {<br/>
        if (elem instanceof MUseCase<br/>
                &amp;&amp; extend instanceof MExtend) {<br/>
            ((MUseCase) elem).removeExtend((MExtend) extend);<br/>
            return;<br/>
        }<br/>
        if (elem instanceof MExtensionPoint<br/>
                &amp;&amp; extend instanceof MExtend) {<br/>
            ((MExtensionPoint) elem).removeExtend((MExtend) extend);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("elem: " + elem<br/>
                + " or extend: " + extend);<br/>
    }<br/>
<br/>
    /**<br/>
     * This method removes an Extension Point from a Use Case or an Extend.<br/>
     *<br/>
     * @param elem is The Use Case or Extend.<br/>
     * @param ep is the extension point<br/>
     */<br/>
    public void removeExtensionPoint(Object elem, Object ep) {<br/>
        if (elem instanceof MUseCase<br/>
                &amp;&amp; ep instanceof MExtensionPoint) {<br/>
            ((MUseCase) elem).removeExtensionPoint((MExtensionPoint) ep);<br/>
            return;<br/>
        }<br/>
        if (elem instanceof MExtend<br/>
                &amp;&amp; ep instanceof MExtensionPoint) {<br/>
            ((MExtend) elem).removeExtensionPoint((MExtensionPoint) ep);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("elem: " + elem + " or ep: " + ep);<br/>
    }<br/>
<br/>
    /**<br/>
     * Remove an include from a Use Case.<br/>
     *<br/>
     * @param usecase The Use Case.<br/>
     * @param include The Include.<br/>
     */<br/>
    public void removeInclude(Object usecase, Object include) {<br/>
        if (usecase instanceof MUseCase<br/>
                &amp;&amp; include instanceof MInclude) {<br/>
            ((MUseCase) usecase).removeInclude((MInclude) include);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("usecase: " + usecase<br/>
                + " or include: " + include);<br/>
    }<br/>
<br/>
    /**<br/>
     * Add an extend to a Use Case or Extension Point.<br/>
     *<br/>
     * @param elem The Use Case or Extension Point.<br/>
     * @param extend The Extend to add.<br/>
     */<br/>
    public void addExtend(Object elem, Object extend) {<br/>
        if (elem instanceof MUseCase<br/>
                &amp;&amp; extend instanceof MExtend) {<br/>
            ((MUseCase) elem).addExtend((MExtend) extend);<br/>
            return;<br/>
        }<br/>
        if (elem instanceof MExtensionPoint<br/>
                &amp;&amp; extend instanceof MExtend) {<br/>
            ((MExtensionPoint) elem).addExtend((MExtend) extend);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("elem: " + elem<br/>
                + " or extend: " + extend);<br/>
    }<br/>
<br/>
    /**<br/>
     * Adds an extension point to some model element.<br/>
     *<br/>
     * @param handle is the model element<br/>
     * @param extensionPoint is the extension point<br/>
     */<br/>
    public void addExtensionPoint(<br/>
            Object handle,<br/>
            Object extensionPoint) {<br/>
        if (extensionPoint instanceof MExtensionPoint) {<br/>
            if (handle instanceof MUseCase) {<br/>
                ((MUseCase) handle).addExtensionPoint(<br/>
                        (MExtensionPoint) extensionPoint);<br/>
                return;<br/>
            }<br/>
            if (handle instanceof MExtend) {<br/>
                ((MExtend) handle).addExtensionPoint(<br/>
                        (MExtensionPoint) extensionPoint);<br/>
                return;<br/>
            }<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle<br/>
                + " or extensionPoint: " + extensionPoint);<br/>
    }<br/>
<br/>
    /**<br/>
     * Add an include to a Use Case.<br/>
     *<br/>
     * @param usecase The Use Case.<br/>
     * @param include The Include.<br/>
     */<br/>
    public void addInclude(Object usecase, Object include) {<br/>
        if (usecase instanceof MUseCase<br/>
                &amp;&amp; include instanceof MInclude) {<br/>
            ((MUseCase) usecase).addInclude((MInclude) include);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("usecase: " + usecase<br/>
                + " or include: " + include);<br/>
    }<br/>
<br/>
    /**<br/>
     * Sets the addition to an include.<br/>
     * There is a bug in NSUML that reverses additions and bases for includes.<br/>
     *<br/>
     * @param handle Include<br/>
     * @param useCase UseCase<br/>
     */<br/>
    public void setAddition(Object handle, Object useCase) {<br/>
        if ((handle instanceof MBase) &amp;&amp; ((MBase) handle).isRemoved()) {<br/>
            throw new IllegalArgumentException("Operation on a removed object ["<br/>
                    + handle + "]");<br/>
        }<br/>
        if ((useCase instanceof MBase) &amp;&amp; ((MBase) useCase).isRemoved()) {<br/>
            throw new IllegalArgumentException("Operation on a removed object ["<br/>
                    + useCase + "]");<br/>
        }<br/>
<br/>
        if (<span class="add"><span class="mv">handle instanceof MInclude</span> &amp;&amp; <span class="add"><span class="mv">useCase</span> instanceof <span class="mv">MUseCase</span></span></span>) {<br/>
            ((MInclude) handle).setBase(<span class="add">(<span class="mv">MUseCase</span>) <span class="mv">useCase</span></span>);<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle);<br/>
    }<br/>
<br/>
    /**<br/>
     * Set the condition of an extend.<br/>
     *<br/>
     * @param handle is the extend<br/>
     * @param booleanExpression is the condition<br/>
     */<br/>
    public void setCondition(Object handle, Object booleanExpression) {<br/>
        if (handle instanceof MExtend<br/>
                &amp;&amp; booleanExpression instanceof MBooleanExpression) {<br/>
            ((MExtend) handle).setCondition(<br/>
                    (MBooleanExpression) booleanExpression);<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle<br/>
                + " or booleanExpression: " + booleanExpression);<br/>
    }<br/>
<br/>
    /**<br/>
     * Set the extension of a usecase.<br/>
     *<br/>
     * @param extend Extend<br/>
     * @param useCase UseCase<br/>
     */<br/>
    public void setExtension(Object extend, Object <span class="mv">useCase</span>) {<br/>
        if (<span class="add">!<span class="mv">(<span class="mv">useCase</span> instanceof MUseCase)</span></span>) {<br/>
            throw new IllegalArgumentException("A use case must be supplied");<br/>
        }<br/>
        <br/>
        if ((extend instanceof MBase) &amp;&amp; ((MBase) extend).isRemoved()) {<br/>
            throw new IllegalStateException("Operation on a removed object ["<br/>
                    + extend + "]");<br/>
        }<br/>
        if ((<span class="mv">useCase</span> instanceof MBase) &amp;&amp; ((MBase) <span class="mv">useCase</span>).isRemoved()) {<br/>
            throw new IllegalStateException("Operation on a removed object ["<br/>
                    + <span class="mv">useCase</span> + "]");<br/>
        }<br/>
<br/>
        if (extend instanceof MExtend<br/>
                &amp;&amp; <span class="add">(<span class="add"><span class="mv">useCase</span> instanceof <span class="mv">MUseCase</span></span>)</span>) {<br/>
            ((MExtend) extend).setExtension(<span class="add">(<span class="mv">MUseCase</span>) <span class="mv">useCase</span></span>);<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + extend<br/>
                + " or ext: " + <span class="add">useCase</span>);<br/>
    }<br/>
<br/>
    /**<br/>
     * Sets the extension points of some use cases or extend relationships.<br/>
     *<br/>
     * @param handle the use case or extend relationship<br/>
     * @param extensionPoints is the extension points<br/>
     */<br/>
    public void setExtensionPoints(<br/>
            Object handle,<br/>
            Collection extensionPoints) {<br/>
        if (<span class="add"><span class="mv">handle</span> instanceof <span class="mv">MUseCase</span></span> &amp;&amp; extensionPoints instanceof List) {<br/>
            <span class="add">(<span class="add">(<span class="mv">MUseCase</span>) <span class="mv">handle</span></span>)</span>.setExtensionPoints(extensionPoints);<br/>
            return;<br/>
        }<br/>
        if (handle instanceof MExtend &amp;&amp; extensionPoints instanceof Collection) {<br/>
            ((MExtend) handle).setExtensionPoints(new ArrayList(extensionPoints));<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle<br/>
                + " or extensionPoints: " + extensionPoints.getClass());<br/>
    }<br/>
<br/>
    /**<br/>
     * Set the collection of Include relationships for a usecase.<br/>
     *<br/>
     * @param handle UseCase<br/>
     * @param includes the collection of Include relationships<br/>
     */<br/>
    public void setIncludes(Object handle, Collection includes) {<br/>
        if (<span class="add"><span class="mv">handle</span> instanceof <span class="mv">MUseCase</span></span>) {<br/>
            <span class="add">(<span class="add">(<span class="mv">MUseCase</span>) <span class="mv">handle</span></span>)</span>.setIncludes(includes);<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle<br/>
                + " or includes: " + includes);<br/>
    }<br/>
<br/>
    /**<br/>
     * Sets a location of some extension point.<br/>
     *<br/>
     * @param handle is the extension point<br/>
     * @param loc is the location<br/>
     */<br/>
    public void setLocation(Object handle, String loc) {<br/>
        if (handle instanceof MExtensionPoint) {<br/>
            ((MExtensionPoint) handle).setLocation(loc);<br/>
            return;<br/>
        }<br/>
        throw new IllegalArgumentException("handle: " + handle);<br/>
    }<br/>
<br/>
    /**<br/>
     * Set a Use Case for an Extension Point.<br/>
     *<br/>
     * @param elem The Extension Point.<br/>
     * @param usecase The Use Case.<br/>
     */<br/>
    public void setUseCase(Object elem, Object usecase) {<br/>
        if (elem instanceof MExtensionPoint<br/>
                &amp;&amp; (<span class="add"><span class="mv">usecase</span> instanceof <span class="mv">MUseCase</span></span><br/>
                        || usecase == null)) {<br/>
            ((MExtensionPoint) elem).setUseCase(<span class="add">(<span class="add"><span class="add">MUseCase</span></span>) <span class="mv">usecase</span></span>);<br/>
            return;<br/>
        }<br/>
<br/>
        throw new IllegalArgumentException("elem: " + elem<br/>
                + " or usecase: " + usecase);<br/>
    }<br/>
}<br/>
</div>
</div>
</div>
<div class="clear"></div>
</div>
</body>
</html>